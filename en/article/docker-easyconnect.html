<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5"><meta name="theme-color" content="#000000"><link rel="manifest" href="/manifest.json"><script src="/sw-register.js"></script><meta name="description" content="When at home on vacation and needed to use EasyConnect to connect to the school&#39;s intranet, so I planned to download it and use it. But! EasyConnect is a rogue software, which is often referred to as"><meta property="og:type" content="article"><meta property="og:title" content="Multiple Solutions for Toxic Software EasyConnect"><meta property="og:url" content="https://vccv.cc/en/article/docker-easyconnect.html"><meta property="og:site_name" content="Yuesir"><meta property="og:description" content="When at home on vacation and needed to use EasyConnect to connect to the school&#39;s intranet, so I planned to download it and use it. But! EasyConnect is a rogue software, which is often referred to as"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://vccv.cc/en/article/docker-easyconnect/v2-ef2d65c9a9b6b65228529a429261160c_r.jpg"><meta property="og:image" content="https://vccv.cc/en/article/docker-easyconnect/v2-31c51548fc67de83039eeedf10bf28c5_r.jpg"><meta property="article:published_time" content="2022-07-08T07:29:12.000Z"><meta property="article:modified_time" content="2022-12-28T16:00:00.000Z"><meta property="article:author" content="Yuesir"><meta property="article:tag" content="docker"><meta property="article:tag" content="easyconnect"><meta property="article:tag" content="clash"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://vccv.cc/en/article/docker-easyconnect/v2-ef2d65c9a9b6b65228529a429261160c_r.jpg"><link rel="shortcut icon" href="/en/images/favicon.ico"><link rel="icon" type="image/png" href="/en/images/favicon-192x192.png" sizes="192x192"><link rel="apple-touch-icon" sizes="180x180" href="/en/images/apple-touch-icon.png"><title>Multiple Solutions for Toxic Software EasyConnect｜Yuesir</title><link rel="stylesheet" href="/en/css/style.css"><link rel="stylesheet" href="/en/css/style-dark.css"><script src="/en/js/switch.js"></script><link rel="stylesheet" href="/en/css/fancybox.css"><meta name="generator" content="Hexo 5.4.2"><link rel="alternate" href="/en/atom.xml" title="Yuesir" type="application/atom+xml">
</head><body class="max-width mx-auto px3 ltr"><div id="header-post"><a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/en">Home</a></li><li><a href="/en/tags">Tag</a></li><li><a href="/en/search">Search</a></li><li><a href="/en/tools">Tool</a></li><li><a href="/en/about">About</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" aria-label="Previous post" href="/en/article/conda-r-jupyter.html"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle()' onmouseout='$("#i-prev").toggle()'></i></a></li><li><a class="icon" aria-label="Next post" href="/en/article/mac-tiling-yabai.html"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle()' onmouseout='$("#i-next").toggle()'></i></a></li><li><a class="icon" aria-label="Back to top" href="#" onclick='$("html, body").animate({scrollTop:0},"fast")'><i class="fas fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle()' onmouseout='$("#i-top").toggle()'></i></a></li><li><a class="icon" aria-label="Switch theme"><i class="fas fa-lightbulb" aria-hidden="true" onmouseover='$("#i-switch").toggle()' onmouseout='$("#i-switch").toggle()' onclick="switchNightMode()"></i></a></li><li><a class="icon" aria-label="Back to home" href="/en/"><i class="fas fa-home" aria-hidden="true" onmouseover='$("#i-home").toggle()' onmouseout='$("#i-home").toggle()'></i></a></li></ul><span id="i-prev" class="info" style="display:none">Previous post</span> <span id="i-next" class="info" style="display:none">Next post</span> <span id="i-top" class="info" style="display:none">Back to top</span> <span id="i-switch" class="info" style="display:none">Switch theme</span> <span id="i-home" class="info" style="display:none">Back to home</span></span><br><div id="toc"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Start"><span class="toc-number">1.</span> <span class="toc-text">Start</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Method-1"><span class="toc-number">2.</span> <span class="toc-text">Method 1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Method-2"><span class="toc-number">3.</span> <span class="toc-text">Method 2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Installing-Docker"><span class="toc-number">3.1.</span> <span class="toc-text">Installing Docker</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Installing-Clash"><span class="toc-number">3.2.</span> <span class="toc-text">Installing Clash</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Install-VNC-Viewer-optional"><span class="toc-number">3.3.</span> <span class="toc-text">Install VNC Viewer (optional)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Installing-a-text-editor"><span class="toc-number">3.4.</span> <span class="toc-text">Installing a text editor</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Running-EasyConnect-with-Docker"><span class="toc-number">3.5.</span> <span class="toc-text">Running EasyConnect with Docker</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Graphical-VNC-Viewer-connection"><span class="toc-number">3.6.</span> <span class="toc-text">Graphical VNC Viewer connection</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Configuring-Clash"><span class="toc-number">3.7.</span> <span class="toc-text">Configuring Clash</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Configure-ClashX"><span class="toc-number">3.8.</span> <span class="toc-text">Configure ClashX</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Configuring-TUN-mode"><span class="toc-number">3.9.</span> <span class="toc-text">Configuring TUN mode</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Filtering-applications"><span class="toc-number">3.10.</span> <span class="toc-text">Filtering applications</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Rebooting"><span class="toc-number">3.11.</span> <span class="toc-text">Rebooting</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Uninstalling-EasyConnect"><span class="toc-number">4.</span> <span class="toc-text">Uninstalling EasyConnect</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Thanks"><span class="toc-number">5.</span> <span class="toc-text">Thanks</span></a></li></ol></div></span></div><div class="content index py4"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><a href="javascript:void(0);" onclick="switchNightMode()"><h1 class="posttitle" itemprop="name headline">Multiple Solutions for Toxic Software EasyConnect</h1></a><div class="meta"><div class="postdate">Posted: <time datetime="2022-07-08T07:29:12.000Z" itemprop="datePublished">2022-07-08</time> (Updated: <time datetime="2022-12-28T16:00:00.000Z" itemprop="dateModified">2022-12-29</time>)</div><div class="article-category"><i class="fas fa-archive"></i> <a class="category-link" href="/en/categories/skill/">skill</a></div><div class="article-tag"><i class="fas fa-tag"></i> <a class="tag-link-link" href="/en/tags/clash/" rel="tag">clash</a>, <a class="tag-link-link" href="/en/tags/docker/" rel="tag">docker</a>, <a class="tag-link-link" href="/en/tags/easyconnect/" rel="tag">easyconnect</a></div></div></header><div class="content" itemprop="articleBody"><h2 id="Start"><a href="#Start" class="headerlink" title="Start"></a>Start</h2><p>I’m at home on vacation and I need to use <strong>EasyConnect</strong> to connect to the school’s intranet. I occasionally need to connect to the school’s server or access intranet pages, so I plan to download it.</p><p>But! EasyConnect is a rogue software, which is often referred to as a cancerous software. I then started looking for ways to deal with it.</p><blockquote><p>Under macOS, EasyConnect primarily behaves as follows.</p><ol><li>background resident processes EasyMonitor and ECAgentProxy, both running with root privileges.</li><li>automatically installs root certificates, including the system root certificate and FireFox root certificate, and reinstalls them after deletion.</li></ol><p>ps: Resident processes with <em>root</em> privileges means that these processes can read and write anything; installing root certificates means that they can directly perform man-in-the-middle attacks and tamper with data at will.</p></blockquote><h2 id="Method-1"><a href="#Method-1" class="headerlink" title="Method 1"></a>Method 1</h2><p>This method is suitable for computers with EasyConnect already installed, with minimal tossing.</p><ol><li><p>use <code>sudo su</code> to obtain administrator privileges.</p></li><li><p>Delete (rm)</p><p>/Library/LaunchDaemons/com.sangfor.EasyMonitor.plist.</p></li><li><p>delete /Library/LaunchAgents/com.sangfor.ECAgentProxy.plist.</p></li><li><p>reboot the Mac.</p></li><li><p>Open the keychain and delete the certificate under System Keychain - System - Certificates (keyword sangfor).</p></li></ol><blockquote><p>Be sure to <em>restart the Mac before deleting the certificate</em>, as the EasyMonitor process in the background will automatically import the certificate after it has been deleted.</p></blockquote><p>This eliminates the problem with EasyConnect. However, so far it causes EasyConnect not to connect, so we need to start EasyConnect in a secure way. Two scripts can be written to achieve start and exit.</p><p><strong>startEasyConnect.sh</strong></p><div class="highlight-wrap" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#! /bin/bash</span></span><br><span class="line"></span><br><span class="line">/Applications/EasyConnect.app/Contents/Resources/bin/EasyMonitor &gt; /dev/null 2&gt;&amp;1 &amp;</span><br><span class="line">/Applications/EasyConnect.app/Contents/MacOS/EasyConnect &gt; /dev/null 2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure></div><p><strong>killEasyMonitor.sh</strong></p><div class="highlight-wrap" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#! /bin/bash</span></span><br><span class="line"></span><br><span class="line">pkill EasyMonitor</span><br><span class="line">pkill ECAgent</span><br><span class="line">pkill ECAgentProxy</span><br></pre></td></tr></table></figure></div><p>Place the above two scripts under the <code>PATH</code> path and grant executable permissions to.</p><div class="highlight-wrap" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> +x startEasyConnect.sh</span><br><span class="line"><span class="built_in">chmod</span> +x killEasyMonitor.sh</span><br></pre></td></tr></table></figure></div><p>When you need to use EasyConnect, execute the <code>startEasyConnect</code> command as <strong>regular user</strong> (the EasyMonitor process will not have permission to import the root certificate). After exiting EasyConnect, run <code>killEasyMonitor</code> to kill the EasyMonitor process in the background.</p><h2 id="Method-2"><a href="#Method-2" class="headerlink" title="Method 2"></a>Method 2</h2><p>Suitable for those who have not yet installed EasyConnect and have some knowledge of Docker and are not afraid of trouble. (being used)</p><h3 id="Installing-Docker"><a href="#Installing-Docker" class="headerlink" title="Installing Docker"></a>Installing Docker</h3><p><a target="_blank" rel="noopener" href="https://docs.docker.com/desktop/windows/install/">Windows</a></p><p><a target="_blank" rel="noopener" href="https://docs.docker.com/desktop/mac/install/">macOS</a></p><h3 id="Installing-Clash"><a href="#Installing-Clash" class="headerlink" title="Installing Clash"></a>Installing Clash</h3><p><a target="_blank" rel="noopener" href="https://github.com/Fndroid/clash_for_windows_pkg/releases">Windows</a></p><p><a target="_blank" rel="noopener" href="https://github.com/yichengchen/clashX/releases">ClashX</a> or <a target="_blank" rel="noopener" href="https://install.appcenter.ms/users/clashx/apps/clashx-pro/distribution_groups/public">ClashX Pro</a> versions can also be installed on macOS</p><h3 id="Install-VNC-Viewer-optional"><a href="#Install-VNC-Viewer-optional" class="headerlink" title="Install VNC Viewer (optional)"></a>Install VNC Viewer (optional)</h3><p>If you are using EasyConnect <strong>which requires</strong> a graphical interface to log in, you need to install VNC Viewer, otherwise you can skip this step.</p><p>If you don’t know, you can skip this step and return to it later when you are prompted to run EasyConnect with Docker and cannot finish in the command line interface.</p><p>The installation of VNC Viewer is very simple, go to the <a target="_blank" rel="noopener" href="https://www.realvnc.com/en/connect/download/viewer/">Download</a> page on the official website, select the appropriate version to download, and then go all the way to the next step to complete.</p><h3 id="Installing-a-text-editor"><a href="#Installing-a-text-editor" class="headerlink" title="Installing a text editor"></a>Installing a text editor</h3><p>Because it involves editing and modifying <strong>yaml</strong> files, you may need to install a <a target="_blank" rel="noopener" href="https://code.visualstudio.com/">VSCode</a>, which does not use Notepad because it does not have highlighting, does not spell words, and does not automatically format, which may cause you to have some indentation, spelling, and punctuation errors that are more It is difficult to find.</p><p>VSCode is free, but here is another recommended software: <strong>Sublime Text</strong> (paid).</p><h3 id="Running-EasyConnect-with-Docker"><a href="#Running-EasyConnect-with-Docker" class="headerlink" title="Running EasyConnect with Docker"></a>Running EasyConnect with Docker</h3><p>First make sure that your Docker is running (try run <code>docker ps -a</code>). Open a terminal and enter different commands depending on whether you need a graphical interface or not.</p><blockquote><p>2022.12.29 Updated</p><p>I am an Intel model of MacBook, according to the reminder of the old brother in the comments section, the following tutorial <strong>does not apply</strong> to Apple’s own M series chips, i.e. <strong>arm architecture</strong> machines.</p><p>Since I don’t have an M-chip machine, please try compiling <strong>non-amd64</strong> branch files on your own if needed, see <a target="_blank" rel="noopener" href="https://github.com/Hagb/docker-easyconnect/issues/167">issue167</a> for details. If you encounter new problems during the compilation process, you can read more issues raised by others.</p></blockquote><p><strong>Pure command line version:</strong></p><div class="highlight-wrap" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">touch</span> ~/.easyconn</span><br><span class="line">docker run --device /dev/net/tun --cap-add NET_ADMIN -v <span class="variable">$HOME</span>/.easyconn:/root/.easyconn -it -p 127.0.0.1:1080:1080 -p 127.0.0.1:8888:8888 -e IPTABLES_LEGACY=1 -e EC_VER=7.6.3 -e CLI_OPTS=<span class="string">&quot;-d vpn.xxx.edu.cn -u USERNAME -p PASSWORD&quot;</span> hagb/docker-easyconnect:cli</span><br></pre></td></tr></table></figure></div><p>The commands are explained below.</p><ul><li>In the first line, we create a configuration file in the <code>$HOME</code> directory of the current user to save login information.</li><li>On the second line, we start an EasyConnect command-line version of the Docker container.<ul><li><code>--device /dev/net/tun --cap-add NET_ADMIN</code> creates the virtual network device.</li><li><code>-it</code> returns an interactive terminal to display information.</li><li><code>-v</code> specifies the mount volume, where we map the configuration file in the <code>$HOME$</code> directory of the current user to the container, enabling the persistence of login information.</li><li><code>-p</code> specifies the port mapping of the container, you can change the port number according to the actual situation. where 1080 is the Socks5 proxy port and 8888 is the HTTP proxy port.</li><li><code>-e EC_VER</code> Set the value of the environment variable <code>EC_VER</code> in the container, specifying the version of Sangfor, preferably the same as the server side.</li><li><code>-e CLI_OPTS</code> sets the value of the environment variable <code>CLI_OPTS</code> in the container, specifying the parameters when running Sangfor. Here <code>-d</code> specifies the VPN address, <code>-u</code> specifies the user name, and <code>-p</code> specifies the user’s password. Please <strong>modify these information yourself correctly</strong>!</li><li><code>-e IPTABLES_LEGACY=1</code> uses the old iptables command, mainly to maintain compatibility with WSL. On some distributions of WSL, the absence of this environment variable will prevent the VPN from functioning properly. (Optional)</li></ul></li></ul><p>Please refer to: <a target="_blank" rel="noopener" href="https://github.com/Hagb/docker-easyconnect/blob/master/doc/usage.md">docker-easyconnect/usage.md</a> for specific parameter settings</p><p><strong>GUI version:</strong></p><div class="highlight-wrap" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run --device /dev/net/tun --cap-add NET_ADMIN -ti -e PASSWORD=xxxx -v <span class="variable">$HOME</span>/.ecdata:/root -p 127.0.0.1:5901:5901 -p 127.0.0.1:1080:1080 hagb/docker-easyconnect:7.6.3</span><br></pre></td></tr></table></figure></div><p>Where <code>hagb/docker-easyconnect:7.6.3</code> means use <code>7.6.3</code> version of EasyConnect, please change the version number according to the actual situation.</p><blockquote><p>PS: When your port 5901 or 1080 is occupied by other services, you can change the port of EasyConnect that we run with docker above by using the following command (for example, the command line version is pure, the GUI version is the same);</p><p>127.0.0.1:<em>15901</em>:5901 and 127.0.0.1:<em>10180</em>:1080. You can change the 15901 and 10180 in 127.0.0.1:<em>15901</em>:1080 to your own unoccupied ports.</p><div class="highlight-wrap" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run --device /dev/net/tun --cap-add NET_ADMIN -ti -e PASSWORD=xxxx -v <span class="variable">$HOME</span>/.ecdata:/root -p 127.0.0.1:15901:5901 -p 127.0.0.1:10180:1080 hagb/docker-easyconnect:7.6.3</span><br></pre></td></tr></table></figure></div></blockquote><h3 id="Graphical-VNC-Viewer-connection"><a href="#Graphical-VNC-Viewer-connection" class="headerlink" title="Graphical VNC Viewer connection"></a>Graphical VNC Viewer connection</h3><p>After typing, open <strong>VNC Viewer</strong>, click <strong>File -&gt; New connection</strong> in the upper left corner, or <strong>right click -&gt; New connection</strong> in the blank space, or use the shortcut key <strong>Ctrl + N</strong> to create a new link, and fill in the VNC Server in the pop-up dialog box <strong>127.0.0.1:5901</strong> , Name can be left out.</p><p><a data-fancybox="gallery" data-src="docker-easyconnect/v2-ef2d65c9a9b6b65228529a429261160c_r.webp" data-caption="VNC Viewer"><picture><source srcset="docker-easyconnect/v2-ef2d65c9a9b6b65228529a429261160c_r.webp" type="image/webp"><img src="docker-easyconnect/v2-ef2d65c9a9b6b65228529a429261160c_r.jpg" alt="VNC Viewer"></picture></a></p><p>After clicking OK, double-click the link we just created, enter the password XXXX, and you’re ready to connect.</p><blockquote><p>It’s much easier to run EasyConnect in Docker without having to enter a captcha.</p><p>It is more convenient.</p><p>Also, the project itself remembers the server address you entered, so you only need to click the login button when you use it in the future.</p></blockquote><p>At this point, you’ll have a socks5 proxy running on <strong>1080 port</strong> on your computer, and the next step is to configure Clash to forward when we need it.</p><h3 id="Configuring-Clash"><a href="#Configuring-Clash" class="headerlink" title="Configuring Clash"></a>Configuring Clash</h3><p>This section describes how you can use EasyConnect’s VPN service when you need it.</p><p>First run Clash, click Profiles in the left navigation bar and you will see a default <strong>config.yaml</strong>, or you can edit other profiles if you have them. Click on the button shaped like <code>&lt; &gt;</code> to the right of the profile you want to edit, meaning edit the profile in a text editor, and add at the end.</p><div class="highlight-wrap" data-rel="Yaml"><figure class="iseeu highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Add a sock5 proxy with the name vpn</span></span><br><span class="line"><span class="attr">proxies:</span></span><br><span class="line">	<span class="bullet">-</span> &#123;<span class="attr">&quot;name&quot;:</span> <span class="string">&quot;vpn&quot;</span>, <span class="attr">&quot;type&quot;:</span> <span class="string">&quot;socks5&quot;</span>, <span class="attr">&quot;server&quot;:</span> <span class="string">&quot;127.0.0.1&quot;</span>, <span class="attr">&quot;port&quot;:</span> <span class="string">&quot;1080&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add rules for ip-cidr</span></span><br><span class="line"><span class="attr">rules:</span></span><br><span class="line">	<span class="bullet">-</span> <span class="string">IP-CIDR,222.192.6.0/24,vpn</span></span><br></pre></td></tr></table></figure></div><blockquote><p>Caution.</p><p>The <code>222.192.6.0/24</code> filled in here means that only the traffic accessing <code>222.192.6.xxx</code> will go through the proxy configured above, which needs to be changed according to your actual situation.</p><p>Of course, if you are editing your own airport configuration file, you need to add the above content under the original <code>proxies</code> and <code>rules</code>, and * cannot add these two attributes*.</p></blockquote><p>At this point, in Clash’s General page, turn <strong>System Proxy</strong> on and you will have access to the school’s intranet, but not to remote desktops and other features, which will require further configuration if you need to use them.</p><h3 id="Configure-ClashX"><a href="#Configure-ClashX" class="headerlink" title="Configure ClashX"></a>Configure ClashX</h3><p>Similar to the above.</p><div class="highlight-wrap" data-rel="Yaml"><figure class="iseeu highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">proxies:</span></span><br><span class="line">	<span class="bullet">-</span> &#123; <span class="attr">name:</span> <span class="string">&#x27;vpn&#x27;</span>, <span class="attr">type:</span> <span class="string">socks5</span>, <span class="attr">server:</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>, <span class="attr">port:</span> <span class="number">1080</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="attr">rules:</span></span><br><span class="line">	<span class="bullet">-</span> <span class="string">&#x27;IP-CIDR,172.20.2.0/24,vpn&#x27;</span></span><br></pre></td></tr></table></figure></div><h3 id="Configuring-TUN-mode"><a href="#Configuring-TUN-mode" class="headerlink" title="Configuring TUN mode"></a>Configuring TUN mode</h3><p>For TUN mode, the official documentation describes it as follows.</p><blockquote><p>For software that does not follow the system proxy, TUN mode can take over its traffic and leave it to CFW. In Windows, TUN mode performs better than TAP mode.</p></blockquote><p>Applications such as browsers use the system agent, and some non-system agent applications can be set up to be handled by CFW. In short, after configuring TUN mode, our requirements are ready to be implemented. To start TUN mode, you need to do the following (<strong>MacOS users skip the first two steps</strong>):</p><ol><li>open the General page of Clash, find Home Directory, click <code>Open Folder</code> on the right to open the <code>Home Directory</code> folder.</li><li>Go to the website <a target="_blank" rel="noopener" href="https://www.wintun.net/">Wintun</a> and click <code>Download Wintun xxx</code> in the interface to download the zip package. Copy <code>wintun.dll</code> from the directory corresponding to <code>wintun-x.xx/wintun/bin</code> to the <code>Home Directory</code> directory according to the system version. Use the <code>amd64</code> version for <code>64</code> based processors for <code>64</code> bit operating systems, and choose the <code>arm64</code> version for M1 Macs.</li><li>Click Manage on the right side of Service Mode in General, and install Service Mode in the window that opens, the application will restart automatically when the installation is finished, and the Earth icon on the right side of Service Mode turns green.</li><li>Click <strong>settings -&gt; Profile Mixin -&gt; YAML</strong>, click <strong>Edit</strong> on the right side of <strong>YAML</strong>, enter the following content, and click the button at the bottom right to save.</li></ol><div class="highlight-wrap" data-rel="Yaml"><figure class="iseeu highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">mixin:</span> </span><br><span class="line">  <span class="attr">hosts:</span></span><br><span class="line">    <span class="attr">&#x27;mtalk.google.com&#x27;:</span> <span class="number">108.177</span><span class="number">.125</span><span class="number">.188</span></span><br><span class="line">    <span class="attr">&#x27;services.googleapis.cn&#x27;:</span> <span class="number">74.125</span><span class="number">.203</span><span class="number">.94</span></span><br><span class="line">    <span class="attr">&#x27;raw.githubusercontent.com&#x27;:</span> <span class="number">151.101</span><span class="number">.76</span><span class="number">.133</span></span><br><span class="line">  <span class="attr">dns:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">default-nameserver:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">223.5</span><span class="number">.5</span><span class="number">.5</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">1.0</span><span class="number">.0</span><span class="number">.1</span></span><br><span class="line">    <span class="attr">ipv6:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">enhanced-mode:</span> <span class="string">redir-host</span> <span class="comment">#fake-ip</span></span><br><span class="line">    <span class="attr">nameserver:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">https://dns.rubyfish.cn/dns-query</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">https://223.5.5.5/dns-query</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">https://dns.pub/dns-query</span></span><br><span class="line">    <span class="attr">fallback:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">https://1.0.0.1/dns-query</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">https://public.dns.iij.jp/dns-query</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">https://dns.twnic.tw/dns-query</span></span><br><span class="line">    <span class="attr">fallback-filter:</span></span><br><span class="line">      <span class="attr">geoip:</span> <span class="literal">true</span></span><br><span class="line">      <span class="attr">ipcidr:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">240.0</span><span class="number">.0</span><span class="number">.0</span><span class="string">/4</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span><span class="string">/32</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="string">/32</span></span><br><span class="line">    <span class="attr">domain:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">+.google.com</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">+.facebook.com</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">+.twitter.com</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">+.youtube.com</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">+.xn--ngstr-lra8j.com</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">+.google.cn</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">+.googleapis.cn</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">+.gvt1.com</span></span><br><span class="line">  <span class="attr">tun:</span> </span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">stack:</span> <span class="string">gvisor</span></span><br><span class="line">    <span class="attr">dns-hijack:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">198.18</span><span class="number">.0</span><span class="number">.2</span><span class="string">:53</span></span><br><span class="line">    <span class="attr">macOS-auto-route:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">macOS-auto-detect-interface:</span> <span class="literal">true</span> <span class="comment"># 自动检测出口网卡</span></span><br></pre></td></tr></table></figure></div><ol start="5"><li>Return to the general page to turn on Mixin, and then click connections to find that all connections are in TUN mode, at which point we have completed all configurations.</li></ol><p>For more detailed configuration, please refer to the <a target="_blank" rel="noopener" href="https://docs.cfw.lbyczf.com/contents/tun.html">TUN mode</a> page of the official documentation.</p><h3 id="Filtering-applications"><a href="#Filtering-applications" class="headerlink" title="Filtering applications"></a>Filtering applications</h3><p>Related rules can be found in.</p><div class="highlight-wrap" data-rel="Yaml"><figure class="iseeu highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">proxies:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">&quot;officeVpnProxy&quot;</span></span><br><span class="line"><span class="attr">type:</span> <span class="string">&quot;socks5&quot;</span></span><br><span class="line"><span class="attr">server:</span> <span class="string">&quot;127.0.0.1&quot;</span></span><br><span class="line"><span class="attr">port:</span> <span class="string">&quot;10180&quot;</span></span><br><span class="line"><span class="attr">proxy-groups:</span></span><br><span class="line"><span class="comment"># programs</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">&quot;programs&quot;</span></span><br><span class="line"><span class="attr">type:</span> <span class="string">select</span></span><br><span class="line"><span class="attr">proxies:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">&quot;DIRECT&quot;</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">&quot;PROXY&quot;</span></span><br><span class="line"><span class="attr">rules:</span></span><br><span class="line"><span class="comment"># programs</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">PROCESS-NAME,vpnkit.exe,programs</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">PROCESS-NAME,vpnkit-bridge.exe,programs</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">PROCESS-NAME,com.docker.dev-envs.exe,programs</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">PROCESS-NAME,com.docker.backend.exe,programs</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">PROCESS-NAME,com.docker.extensions.exe,programs</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">PROCESS-NAME,com.docker.proxy.exe,programs</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">PROCESS-NAME,com.docker.service,programs</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">PROCESS-NAME,com.docker.wsl-distro-proxy.exe,programs</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">PROCESS-NAME,Docker</span> <span class="string">Desktop.exe,programs</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">PROCESS-NAME,docker.exe,programs</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">PROCESS-NAME,wsl.exe,programs</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">PROCESS-NAME,wslhost.exe,programs</span></span><br></pre></td></tr></table></figure></div><blockquote><p>Note: The ports should correspond to the ports you configured in the previous docker configuration.</p></blockquote><h3 id="Rebooting"><a href="#Rebooting" class="headerlink" title="Rebooting"></a>Rebooting</h3><p>When you close the terminal window or reboot your computer and want to start Docker again, we just need to start the appropriate container and click Login in VNC Viewer (if you don’t use the graphical interface, you only need to start the container).</p><p>To start the container, you don’t need to type the command above to create the container, because the command means create the container, download the image, start and enter the container, we have already created the container, we just need to start it later. So, we first need to know what containers we have, and then start the corresponding containers on it.</p><p>First, look at the containers we already have</p><div class="highlight-wrap" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker ps -a</span><br></pre></td></tr></table></figure></div><p>You should get similar output, and if this is your first time using Docker, you should only have one container</p><p><a data-fancybox="gallery" data-src="docker-easyconnect/v2-31c51548fc67de83039eeedf10bf28c5_r.webp" data-caption="docker container"><picture><source srcset="docker-easyconnect/v2-31c51548fc67de83039eeedf10bf28c5_r.webp" type="image/webp"><img src="docker-easyconnect/v2-31c51548fc67de83039eeedf10bf28c5_r.jpg" alt="docker container"></picture></a></p><p>When you want to turn it on again after the computer has restarted, just type.</p><div class="highlight-wrap" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker start 81f</span><br></pre></td></tr></table></figure></div><p>The <code>81f</code> is the <code>ID</code> of the container I want to start, which is the value of the first column, it’s a long value, usually you only need to enter the first few digits, or you can change it with the <code>docker rename</code> command.</p><div class="highlight-wrap" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker rename OLDNAME NEWNAME</span><br></pre></td></tr></table></figure></div><h2 id="Uninstalling-EasyConnect"><a href="#Uninstalling-EasyConnect" class="headerlink" title="Uninstalling EasyConnect"></a>Uninstalling EasyConnect</h2><p>As I said before, one of the rogue things about EasyConnect is that it is very difficult to uninstall, but I have come up with a method based on information from the Internet and my own experience.</p><p>First, find the EasyConnect installation directory and double-click it to run the uninstaller, then you will see that the directory is not completely deleted, there are still a lot of files, so let’s perform the following steps.</p><ol><li>select all Shift + Delete, if you encounter the one that does not give the deletion will be skipped, then there will still be many files left.</li><li>Disconnect and restart the computer, come to the installation directory, change the names of all the folders, change them to whatever you want, restart again</li><li>Select all the folders that have just been renamed Shift + Delete, if this time still can not delete the folder cut to another place and then delete</li><li>restart the computer, administrator privileges to open the command line (if you do not have the usual command line tools can Win + X select <strong>Windows PowerShell (Administrator)</strong>)</li><li>enter the command <code>netsh winsock reset</code> and enter</li></ol><p>The last two steps to reset winsock are very important, if not performed will likely be a variety of clients can not connect to the network situation.</p><p>If you still have the <strong>sanfor</strong> service after uninstallation, you can refer to <a target="_blank" rel="noopener" href="https://www.zhihu.com/question/333699380/answer/2358761655">this article</a> to try to solve it.</p><h2 id="Thanks"><a href="#Thanks" class="headerlink" title="Thanks"></a>Thanks</h2><p><a target="_blank" rel="noopener" href="https://github.com/Hagb/docker-easyconnect">docker-easyconnect</a></p><p><a target="_blank" rel="noopener" href="https://soulike.tech/article/64">Soulike</a></p><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/389894063">Jortana</a></p><p><a target="_blank" rel="noopener" href="https://naiv.fun/Ops/sangfor-in-docker.html">Nativus</a></p><div id="copyright"><style>#easter-egg{border:0;padding:10px 0;position:relative}#easter-egg::before{font-family:"Font Awesome 5 Free";font-weight:900;content:"Page Over \f1b0  Thank You";position:absolute;padding:0 10px;line-height:1px;white-space:nowrap;left:50%;transform:translateX(-50%)}</style><hr id="easter-egg"><blockquote style="padding:0"><p>Author: Yuesir</p><p>Link: <a href="/en/article/docker-easyconnect.html" target="_blank" title="Multiple Solutions for Toxic Software EasyConnect">https://vccv.cc/en/article/docker-easyconnect.html</a></p><p>Copyright: All articles except special statements are used <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">CC BY-NC-ND 4.0</a> license agreement, reproduced please indicate the source!</p></blockquote><hr></div></div></article><div class="blog-post-comments"><div id="tcomment"><noscript>Please enable JavaScript to view the comments.</noscript></div></div><div id="footer-post-container"><div id="footer-post"><div id="nav-footer" style="display:none"><ul><li><a href="/en">Home</a></li><li><a href="/en/tags">Tag</a></li><li><a href="/en/search">Search</a></li><li><a href="/en/tools">Tool</a></li><li><a href="/en/about">About</a></li></ul></div><div id="toc-footer" style="display:none"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Start"><span class="toc-number">1.</span> <span class="toc-text">Start</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Method-1"><span class="toc-number">2.</span> <span class="toc-text">Method 1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Method-2"><span class="toc-number">3.</span> <span class="toc-text">Method 2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Installing-Docker"><span class="toc-number">3.1.</span> <span class="toc-text">Installing Docker</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Installing-Clash"><span class="toc-number">3.2.</span> <span class="toc-text">Installing Clash</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Install-VNC-Viewer-optional"><span class="toc-number">3.3.</span> <span class="toc-text">Install VNC Viewer (optional)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Installing-a-text-editor"><span class="toc-number">3.4.</span> <span class="toc-text">Installing a text editor</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Running-EasyConnect-with-Docker"><span class="toc-number">3.5.</span> <span class="toc-text">Running EasyConnect with Docker</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Graphical-VNC-Viewer-connection"><span class="toc-number">3.6.</span> <span class="toc-text">Graphical VNC Viewer connection</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Configuring-Clash"><span class="toc-number">3.7.</span> <span class="toc-text">Configuring Clash</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Configure-ClashX"><span class="toc-number">3.8.</span> <span class="toc-text">Configure ClashX</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Configuring-TUN-mode"><span class="toc-number">3.9.</span> <span class="toc-text">Configuring TUN mode</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Filtering-applications"><span class="toc-number">3.10.</span> <span class="toc-text">Filtering applications</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Rebooting"><span class="toc-number">3.11.</span> <span class="toc-text">Rebooting</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Uninstalling-EasyConnect"><span class="toc-number">4.</span> <span class="toc-text">Uninstalling EasyConnect</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Thanks"><span class="toc-number">5.</span> <span class="toc-text">Thanks</span></a></li></ol></div><div id="actions-footer"><a id="menu" class="icon" onclick='$("#nav-footer").toggle()'><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a> <a id="toc" class="icon" onclick='$("#toc-footer").toggle()'><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a> <a id="switch" class="icon" onclick="switchNightMode()"><i class="fas fa-lightbulb fa-lg" aria-hidden="true"></i> Theme</a> <a id="top" style="display:none" class="icon" href="#" onclick='$("html, body").animate({scrollTop:0},"fast")'><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a></div></div></div><footer id="footer"><div class="footer-left">Copyright &copy; 2020-2024 Yuesir <a href="https://github.com/probberechts/hexo-theme-cactus" rel="nofollow" target="_blank">Cactus</a> <a href="/en/atom.xml" target="_blank">RSS</a></div><div class="footer-right"><nav><ul><li><a href="/en">Home</a></li><li><a href="/en/tags">Tag</a></li><li><a href="/en/search">Search</a></li><li><a href="/en/tools">Tool</a></li><li><a href="/en/about">About</a></li></ul></nav></div></footer></div><link rel="preload" href="/en/lib/font-awesome/css/all.min.css" as="style" onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel="stylesheet" href="/en/lib/font-awesome/css/all.min.css"></noscript><script src="/en/lib/jquery/jquery.min.js"></script><script src="/en/lib/clipboard/clipboard.min.js"></script><script type="text/javascript">$((function(){$(".highlight table").before('<span class="btn-copy tooltipped tooltipped-sw" aria-label="Copy to clipboard"><i class="far fa-clone"></i></span>'),new ClipboardJS(".btn-copy",{text:function(e){return Array.from(e.nextElementSibling.querySelectorAll(".code")).reduce((e,t)=>e+t.innerText+"\n","").replace(/^\s+|\s+$/g,"")}}).on("success",(function(e){e.trigger.setAttribute("aria-label","Copied!"),e.clearSelection()}))}))</script><script src="/en/js/main.js"></script><script src="/en/lib/fancybox/fancybox.umd.js"></script><script src="/en/lib/twikoo/twikoo.all.min.js"></script><script>twikoo.init({envId:"https://twikoo.vccv.cc",el:"#tcomment",lang:"en",onCommentLoaded:function(){for(var t=document.getElementsByClassName("tk-content"),e=0;e<t.length;e++){var n=t[e].getElementsByTagName("img");if(n.length>0)for(var a=0;a<n.length;a++){var o=n[a];if("tk-owo-emotion"!=o.className){var r=document.createElement("a");r.setAttribute("data-fancybox","gallery"),r.setAttribute("data-src",o.getAttribute("src")),r.setAttribute("data-caption","Comment: "+o.getAttribute("alt")),r.appendChild(o.cloneNode(!1)),o.parentNode.insertBefore(r,o.nextSibling),o.remove()}}}}})</script><script src="/lib/april-fool/load.js"></script></body></html>