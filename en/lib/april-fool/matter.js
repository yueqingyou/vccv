!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("Matter",[],t):"object"==typeof exports?exports.Matter=t():e.Matter=t()}(this,function(){return n=[function(e,t){var n,l={};(e.exports=l)._baseDelta=1e3/60,l._nextId=0,l._seed=0,l._nowStartTime=+new Date,l._warnedOnce={},l._decomp=null,l.extend=function(e,t){for(var n,o="boolean"==typeof t?(n=2,t):(n=1,!0),i=n;i<arguments.length;i++){var r=arguments[i];if(r)for(var s in r)!o||!r[s]||r[s].constructor!==Object||e[s]&&e[s].constructor!==Object?e[s]=r[s]:(e[s]=e[s]||{},l.extend(e[s],o,r[s]))}return e},l.clone=function(e,t){return l.extend({},t,e)},l.keys=function(e){if(Object.keys)return Object.keys(e);var t,n=[];for(t in e)n.push(t);return n},l.values=function(e){var t=[];if(Object.keys)for(var n=Object.keys(e),o=0;o<n.length;o++)t.push(e[n[o]]);else for(var i in e)t.push(e[i]);return t},l.get=function(e,t,n,o){t=t.split(".").slice(n,o);for(var i=0;i<t.length;i+=1)e=e[t[i]];return e},l.set=function(e,t,n,o,i){o=t.split(".").slice(o,i);return l.get(e,t,0,-1)[o[o.length-1]]=n},l.shuffle=function(e){for(var t=e.length-1;0<t;t--){var n=Math.floor(l.random()*(t+1)),o=e[t];e[t]=e[n],e[n]=o}return e},l.choose=function(e){return e[Math.floor(l.random()*e.length)]},l.isElement=function(e){return"undefined"!=typeof HTMLElement?e instanceof HTMLElement:!!(e&&e.nodeType&&e.nodeName)},l.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},l.isFunction=function(e){return"function"==typeof e},l.isPlainObject=function(e){return"object"==typeof e&&e.constructor===Object},l.isString=function(e){return"[object String]"===toString.call(e)},l.clamp=function(e,t,n){return e<t?t:n<e?n:e},l.sign=function(e){return e<0?-1:1},l.now=function(){if("undefined"!=typeof window&&window.performance){if(window.performance.now)return window.performance.now();if(window.performance.webkitNow)return window.performance.webkitNow()}return Date.now?Date.now():new Date-l._nowStartTime},l.random=function(e,t){return t=void 0!==t?t:1,(e=void 0!==e?e:0)+n()*(t-e)},n=function(){return l._seed=(9301*l._seed+49297)%233280,l._seed/233280},l.colorToNumber=function(e){return 3==(e=e.replace("#","")).length&&(e=e.charAt(0)+e.charAt(0)+e.charAt(1)+e.charAt(1)+e.charAt(2)+e.charAt(2)),parseInt(e,16)},l.logLevel=1,l.log=function(){console&&0<l.logLevel&&l.logLevel<=3&&console.log.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},l.info=function(){console&&0<l.logLevel&&l.logLevel<=2&&console.info.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},l.warn=function(){console&&0<l.logLevel&&l.logLevel<=3&&console.warn.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},l.warnOnce=function(){var e=Array.prototype.slice.call(arguments).join(" ");l._warnedOnce[e]||(l.warn(e),l._warnedOnce[e]=!0)},l.deprecated=function(e,t,n){e[t]=l.chain(function(){l.warnOnce("🔅 deprecated 🔅",n)},e[t])},l.nextId=function(){return l._nextId++},l.indexOf=function(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0;n<e.length;n++)if(e[n]===t)return n;return-1},l.map=function(e,t){if(e.map)return e.map(t);for(var n=[],o=0;o<e.length;o+=1)n.push(t(e[o]));return n},l.topologicalSort=function(e){var t,n=[],o=[],i=[];for(t in e)o[t]||i[t]||l._topologicalSort(t,o,i,e,n);return n},l._topologicalSort=function(e,t,n,o,i){var r=o[e]||[];n[e]=!0;for(var s=0;s<r.length;s+=1){var a=r[s];n[a]||t[a]||l._topologicalSort(a,t,n,o,i)}n[e]=!1,t[e]=!0,i.push(e)},l.chain=function(){for(var r=[],e=0;e<arguments.length;e+=1){var t=arguments[e];t._chained?r.push.apply(r,t._chained):r.push(t)}function n(){for(var e,t=new Array(arguments.length),n=0,o=arguments.length;n<o;n++)t[n]=arguments[n];for(n=0;n<r.length;n+=1){var i=r[n].apply(e,t);void 0!==i&&(e=i)}return e}return n._chained=r,n},l.chainPathBefore=function(e,t,n){return l.set(e,t,l.chain(n,l.get(e,t)))},l.chainPathAfter=function(e,t,n){return l.set(e,t,l.chain(l.get(e,t),n))},l.setDecomp=function(e){l._decomp=e},l.getDecomp=function(){var t=l._decomp;try{(t=t||"undefined"==typeof window?t:window.decomp)||"undefined"==typeof global||(t=global.decomp)}catch(e){t=null}return t}},function(e,t){var n={};(e.exports=n).create=function(e){var t={min:{x:0,y:0},max:{x:0,y:0}};return e&&n.update(t,e),t},n.update=function(e,t,n){e.min.x=1/0,e.max.x=-1/0,e.min.y=1/0,e.max.y=-1/0;for(var o=0;o<t.length;o++){var i=t[o];i.x>e.max.x&&(e.max.x=i.x),i.x<e.min.x&&(e.min.x=i.x),i.y>e.max.y&&(e.max.y=i.y),i.y<e.min.y&&(e.min.y=i.y)}n&&(0<n.x?e.max.x+=n.x:e.min.x+=n.x,0<n.y?e.max.y+=n.y:e.min.y+=n.y)},n.contains=function(e,t){return t.x>=e.min.x&&t.x<=e.max.x&&t.y>=e.min.y&&t.y<=e.max.y},n.overlaps=function(e,t){return e.min.x<=t.max.x&&e.max.x>=t.min.x&&e.max.y>=t.min.y&&e.min.y<=t.max.y},n.translate=function(e,t){e.min.x+=t.x,e.max.x+=t.x,e.min.y+=t.y,e.max.y+=t.y},n.shift=function(e,t){var n=e.max.x-e.min.x,o=e.max.y-e.min.y;e.min.x=t.x,e.max.x=t.x+n,e.min.y=t.y,e.max.y=t.y+o}},function(e,t){var n={};(e.exports=n).create=function(e,t){return{x:e||0,y:t||0}},n.clone=function(e){return{x:e.x,y:e.y}},n.magnitude=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},n.magnitudeSquared=function(e){return e.x*e.x+e.y*e.y},n.rotate=function(e,t,n){var o=Math.cos(t),t=Math.sin(t),i=e.x*o-e.y*t;return(n=n||{}).y=e.x*t+e.y*o,n.x=i,n},n.rotateAbout=function(e,t,n,o){var i=Math.cos(t),t=Math.sin(t),r=n.x+((e.x-n.x)*i-(e.y-n.y)*t);return(o=o||{}).y=n.y+((e.x-n.x)*t+(e.y-n.y)*i),o.x=r,o},n.normalise=function(e){var t=n.magnitude(e);return 0===t?{x:0,y:0}:{x:e.x/t,y:e.y/t}},n.dot=function(e,t){return e.x*t.x+e.y*t.y},n.cross=function(e,t){return e.x*t.y-e.y*t.x},n.cross3=function(e,t,n){return(t.x-e.x)*(n.y-e.y)-(t.y-e.y)*(n.x-e.x)},n.add=function(e,t,n){return(n=n||{}).x=e.x+t.x,n.y=e.y+t.y,n},n.sub=function(e,t,n){return(n=n||{}).x=e.x-t.x,n.y=e.y-t.y,n},n.mult=function(e,t){return{x:e.x*t,y:e.y*t}},n.div=function(e,t){return{x:e.x/t,y:e.y/t}},n.perp=function(e,t){return{x:(t=!0===t?-1:1)*-e.y,y:t*e.x}},n.neg=function(e){return{x:-e.x,y:-e.y}},n.angle=function(e,t){return Math.atan2(t.y-e.y,t.x-e.x)},n._temp=[n.create(),n.create(),n.create(),n.create(),n.create(),n.create()]},function(e,t,n){var s={},x=(e.exports=s,n(2)),h=n(0);s.create=function(e,t){for(var n=[],o=0;o<e.length;o++){var i=e[o],i={x:i.x,y:i.y,index:o,body:t,isInternal:!1};n.push(i)}return n},s.fromPath=function(e,t){var o=[];return e.replace(/L?\s*([-\d.e]+)[\s,]*([-\d.e]+)*/gi,function(e,t,n){o.push({x:parseFloat(t),y:parseFloat(n)})}),s.create(o,t)},s.centre=function(e){for(var t,n,o=s.area(e,!0),i={x:0,y:0},r=0;r<e.length;r++)n=(r+1)%e.length,t=x.cross(e[r],e[n]),n=x.mult(x.add(e[r],e[n]),t),i=x.add(i,n);return x.div(i,6*o)},s.mean=function(e){for(var t={x:0,y:0},n=0;n<e.length;n++)t.x+=e[n].x,t.y+=e[n].y;return x.div(t,e.length)},s.area=function(e,t){for(var n=0,o=e.length-1,i=0;i<e.length;i++)n+=(e[o].x-e[i].x)*(e[o].y+e[i].y),o=i;return t?n/2:Math.abs(n)/2},s.inertia=function(e,t){for(var n,o,i=0,r=0,s=e,a=0;a<s.length;a++)o=(a+1)%s.length,i+=(n=Math.abs(x.cross(s[o],s[a])))*(x.dot(s[o],s[o])+x.dot(s[o],s[a])+x.dot(s[a],s[a])),r+=n;return t/6*(i/r)},s.translate=function(e,t,n){for(var o=e.length,i=t.x*(n=void 0!==n?n:1),r=t.y*n,s=0;s<o;s++)e[s].x+=i,e[s].y+=r;return e},s.rotate=function(e,t,n){if(0!==t){for(var o,i,r,s=Math.cos(t),a=Math.sin(t),l=n.x,c=n.y,u=e.length,d=0;d<u;d++)i=(o=e[d]).x-l,r=o.y-c,o.x=l+(i*s-r*a),o.y=c+(i*a+r*s);return e}},s.contains=function(e,t){for(var n,o=t.x,i=t.y,r=e.length,s=e[r-1],a=0;a<r;a++){if(n=e[a],0<(o-s.x)*(n.y-s.y)+(i-s.y)*(s.x-n.x))return!1;s=n}return!0},s.scale=function(e,t,n,o){if(1!==t||1!==n){var i;o=o||s.centre(e);for(var r=0;r<e.length;r++)i=e[r],i=x.sub(i,o),e[r].x=o.x+i.x*t,e[r].y=o.y+i.y*n}return e},s.chamfer=function(e,t,n,o,i){t="number"==typeof t?[t]:t||[8],n=void 0!==n?n:-1,o=o||2,i=i||14;for(var r=[],s=0;s<e.length;s++){var a=e[0<=s-1?s-1:e.length-1],l=e[s],c=e[(s+1)%e.length],u=t[s<t.length?s:t.length-1];if(0!==u){var a=x.normalise({x:l.y-a.y,y:a.x-l.x}),c=x.normalise({x:c.y-l.y,y:l.x-c.x}),d=Math.sqrt(2*Math.pow(u,2)),p=x.mult(h.clone(a),u),f=x.normalise(x.mult(x.add(a,c),.5)),y=x.sub(l,x.mult(f,d)),v=n;-1===n&&(v=1.75*Math.pow(u,.32)),(v=h.clamp(v,o,i))%2==1&&(v+=1);for(var m=Math.acos(x.dot(a,c))/v,g=0;g<v;g++)r.push(x.add(x.rotate(p,m*g),y))}else r.push(l)}return r},s.clockwiseSort=function(e){var n=s.mean(e);return e.sort(function(e,t){return x.angle(n,e)-x.angle(n,t)}),e},s.isConvex=function(e){var t,n,o,i,r=0,s=e.length;if(s<3)return null;for(t=0;t<s;t++)if(i=(e[n=(t+1)%s].x-e[t].x)*(e[o=(t+2)%s].y-e[n].y),(i-=(e[n].y-e[t].y)*(e[o].x-e[n].x))<0?r|=1:0<i&&(r|=2),3===r)return!1;return 0!==r||null},s.hull=function(e){var t,n,o=[],i=[];for((e=e.slice(0)).sort(function(e,t){var n=e.x-t.x;return 0!=n?n:e.y-t.y}),n=0;n<e.length;n+=1){for(t=e[n];2<=i.length&&x.cross3(i[i.length-2],i[i.length-1],t)<=0;)i.pop();i.push(t)}for(n=e.length-1;0<=n;--n){for(t=e[n];2<=o.length&&x.cross3(o[o.length-2],o[o.length-1],t)<=0;)o.pop();o.push(t)}return o.pop(),i.pop(),o.concat(i)}},function(e,t,n){var o,c={},u=(e.exports=c,n(3)),d=n(2),i=n(7),p=n(0),f=n(1),y=n(11);c._timeCorrection=!0,c._inertiaScale=4,c._nextCollidingGroupId=1,c._nextNonCollidingGroupId=-1,c._nextCategory=1,c._baseDelta=1e3/60,c.create=function(e){var t={id:p.nextId(),type:"body",label:"Body",parts:[],plugin:{},angle:0,vertices:u.fromPath("L 0 0 L 40 0 L 40 40 L 0 40"),position:{x:0,y:0},force:{x:0,y:0},torque:0,positionImpulse:{x:0,y:0},constraintImpulse:{x:0,y:0,angle:0},totalContacts:0,speed:0,angularSpeed:0,velocity:{x:0,y:0},angularVelocity:0,isSensor:!1,isStatic:!1,isSleeping:!1,motion:0,sleepThreshold:60,density:.001,restitution:0,friction:.1,frictionStatic:.5,frictionAir:.01,collisionFilter:{category:1,mask:4294967295,group:0},slop:.05,timeScale:1,render:{visible:!0,opacity:1,strokeStyle:null,fillStyle:null,lineWidth:null,sprite:{xScale:1,yScale:1,xOffset:0,yOffset:0}},events:null,bounds:null,chamfer:null,circleRadius:0,positionPrev:null,anglePrev:0,parent:null,axes:null,area:0,mass:0,inertia:0,deltaTime:1e3/60,_original:null},t=p.extend(t,e);return o(t,e),t},c.nextGroup=function(e){return e?c._nextNonCollidingGroupId--:c._nextCollidingGroupId++},c.nextCategory=function(){return c._nextCategory=c._nextCategory<<1,c._nextCategory},o=function(e,t){t=t||{},c.set(e,{bounds:e.bounds||f.create(e.vertices),positionPrev:e.positionPrev||d.clone(e.position),anglePrev:e.anglePrev||e.angle,vertices:e.vertices,parts:e.parts||[e],isStatic:e.isStatic,isSleeping:e.isSleeping,parent:e.parent||e}),u.rotate(e.vertices,e.angle,e.position),y.rotate(e.axes,e.angle),f.update(e.bounds,e.vertices,e.velocity),c.set(e,{axes:t.axes||e.axes,area:t.area||e.area,mass:t.mass||e.mass,inertia:t.inertia||e.inertia});var t=e.isStatic?"#14151f":p.choose(["#f19648","#f5d259","#f55a3c","#063e7b","#ececd1"]),n=e.isStatic?"#555":"#ccc",o=e.isStatic&&null===e.render.fillStyle?1:0;e.render.fillStyle=e.render.fillStyle||t,e.render.strokeStyle=e.render.strokeStyle||n,e.render.lineWidth=e.render.lineWidth||o,e.render.sprite.xOffset+=-(e.bounds.min.x-e.position.x)/(e.bounds.max.x-e.bounds.min.x),e.render.sprite.yOffset+=-(e.bounds.min.y-e.position.y)/(e.bounds.max.y-e.bounds.min.y)},c.set=function(e,t,n){for(var o in"string"==typeof t&&(o=t,(t={})[o]=n),t)if(Object.prototype.hasOwnProperty.call(t,o))switch(n=t[o],o){case"isStatic":c.setStatic(e,n);break;case"isSleeping":i.set(e,n);break;case"mass":c.setMass(e,n);break;case"density":c.setDensity(e,n);break;case"inertia":c.setInertia(e,n);break;case"vertices":c.setVertices(e,n);break;case"position":c.setPosition(e,n);break;case"angle":c.setAngle(e,n);break;case"velocity":c.setVelocity(e,n);break;case"angularVelocity":c.setAngularVelocity(e,n);break;case"speed":c.setSpeed(e,n);break;case"angularSpeed":c.setAngularSpeed(e,n);break;case"parts":c.setParts(e,n);break;case"centre":c.setCentre(e,n);break;default:e[o]=n}},c.setStatic=function(e,t){for(var n=0;n<e.parts.length;n++){var o=e.parts[n];(o.isStatic=t)?(o._original={restitution:o.restitution,friction:o.friction,mass:o.mass,inertia:o.inertia,density:o.density,inverseMass:o.inverseMass,inverseInertia:o.inverseInertia},o.restitution=0,o.friction=1,o.mass=o.inertia=o.density=1/0,o.inverseMass=o.inverseInertia=0,o.positionPrev.x=o.position.x,o.positionPrev.y=o.position.y,o.anglePrev=o.angle,o.angularVelocity=0,o.speed=0,o.angularSpeed=0,o.motion=0):o._original&&(o.restitution=o._original.restitution,o.friction=o._original.friction,o.mass=o._original.mass,o.inertia=o._original.inertia,o.density=o._original.density,o.inverseMass=o._original.inverseMass,o.inverseInertia=o._original.inverseInertia,o._original=null)}},c.setMass=function(e,t){var n=e.inertia/(e.mass/6);e.inertia=t/6*n,e.inverseInertia=1/e.inertia,e.mass=t,e.inverseMass=1/e.mass,e.density=e.mass/e.area},c.setDensity=function(e,t){c.setMass(e,t*e.area),e.density=t},c.setInertia=function(e,t){e.inertia=t,e.inverseInertia=1/e.inertia},c.setVertices=function(e,t){t[0].body===e?e.vertices=t:e.vertices=u.create(t,e),e.axes=y.fromVertices(e.vertices),e.area=u.area(e.vertices),c.setMass(e,e.density*e.area);t=u.centre(e.vertices);u.translate(e.vertices,t,-1),c.setInertia(e,c._inertiaScale*u.inertia(e.vertices,e.mass)),u.translate(e.vertices,e.position),f.update(e.bounds,e.vertices,e.velocity)},c.setParts=function(e,t,n){for(t=t.slice(0),e.parts.length=0,e.parts.push(e),e.parent=e,r=0;r<t.length;r++){var o=t[r];o!==e&&(o.parent=e).parts.push(o)}if(1!==e.parts.length){if(n=void 0===n||n){for(var i=[],r=0;r<t.length;r++)i=i.concat(t[r].vertices);u.clockwiseSort(i);var n=u.hull(i),s=u.centre(n);c.setVertices(e,n),u.translate(e.vertices,s)}n=c._totalProperties(e);e.area=n.area,(e.parent=e).position.x=n.centre.x,e.position.y=n.centre.y,e.positionPrev.x=n.centre.x,e.positionPrev.y=n.centre.y,c.setMass(e,n.mass),c.setInertia(e,n.inertia),c.setPosition(e,n.centre)}},c.setCentre=function(e,t,n){n?(e.positionPrev.x+=t.x,e.positionPrev.y+=t.y,e.position.x+=t.x,e.position.y+=t.y):(e.positionPrev.x=t.x-(e.position.x-e.positionPrev.x),e.positionPrev.y=t.y-(e.position.y-e.positionPrev.y),e.position.x=t.x,e.position.y=t.y)},c.setPosition=function(e,t,n){var o=d.sub(t,e.position);n?(e.positionPrev.x=e.position.x,e.positionPrev.y=e.position.y,e.velocity.x=o.x,e.velocity.y=o.y,e.speed=d.magnitude(o)):(e.positionPrev.x+=o.x,e.positionPrev.y+=o.y);for(var i=0;i<e.parts.length;i++){var r=e.parts[i];r.position.x+=o.x,r.position.y+=o.y,u.translate(r.vertices,o),f.update(r.bounds,r.vertices,e.velocity)}},c.setAngle=function(e,t,n){var o=t-e.angle;n?(e.anglePrev=e.angle,e.angularVelocity=o,e.angularSpeed=Math.abs(o)):e.anglePrev+=o;for(var i=0;i<e.parts.length;i++){var r=e.parts[i];r.angle+=o,u.rotate(r.vertices,o,e.position),y.rotate(r.axes,o),f.update(r.bounds,r.vertices,e.velocity),0<i&&d.rotateAbout(r.position,o,e.position,r.position)}},c.setVelocity=function(e,t){var n=e.deltaTime/c._baseDelta;e.positionPrev.x=e.position.x-t.x*n,e.positionPrev.y=e.position.y-t.y*n,e.velocity.x=(e.position.x-e.positionPrev.x)/n,e.velocity.y=(e.position.y-e.positionPrev.y)/n,e.speed=d.magnitude(e.velocity)},c.getVelocity=function(e){var t=c._baseDelta/e.deltaTime;return{x:(e.position.x-e.positionPrev.x)*t,y:(e.position.y-e.positionPrev.y)*t}},c.getSpeed=function(e){return d.magnitude(c.getVelocity(e))},c.setSpeed=function(e,t){c.setVelocity(e,d.mult(d.normalise(c.getVelocity(e)),t))},c.setAngularVelocity=function(e,t){var n=e.deltaTime/c._baseDelta;e.anglePrev=e.angle-t*n,e.angularVelocity=(e.angle-e.anglePrev)/n,e.angularSpeed=Math.abs(e.angularVelocity)},c.getAngularVelocity=function(e){return(e.angle-e.anglePrev)*c._baseDelta/e.deltaTime},c.getAngularSpeed=function(e){return Math.abs(c.getAngularVelocity(e))},c.setAngularSpeed=function(e,t){c.setAngularVelocity(e,p.sign(c.getAngularVelocity(e))*t)},c.translate=function(e,t,n){c.setPosition(e,d.add(e.position,t),n)},c.rotate=function(e,t,n,o){var i,r,s,a;n&&(i=Math.cos(t),r=Math.sin(t),s=e.position.x-n.x,a=e.position.y-n.y,c.setPosition(e,{x:n.x+(s*i-a*r),y:n.y+(s*r+a*i)},o)),c.setAngle(e,e.angle+t,o)},c.scale=function(e,t,n,o){var i=0,r=0;o=o||e.position;for(var s=0;s<e.parts.length;s++){var a=e.parts[s];u.scale(a.vertices,t,n,o),a.axes=y.fromVertices(a.vertices),a.area=u.area(a.vertices),c.setMass(a,e.density*a.area),u.translate(a.vertices,{x:-a.position.x,y:-a.position.y}),c.setInertia(a,c._inertiaScale*u.inertia(a.vertices,a.mass)),u.translate(a.vertices,{x:a.position.x,y:a.position.y}),0<s&&(i+=a.area,r+=a.inertia),a.position.x=o.x+(a.position.x-o.x)*t,a.position.y=o.y+(a.position.y-o.y)*n,f.update(a.bounds,a.vertices,e.velocity)}1<e.parts.length&&(e.area=i,e.isStatic||(c.setMass(e,e.density*i),c.setInertia(e,r))),e.circleRadius&&(t===n?e.circleRadius*=t:e.circleRadius=null)},c.update=function(e,t){var n=(t=(void 0!==t?t:1e3/60)*e.timeScale)*t,o=c._timeCorrection?t/(e.deltaTime||t):1,i=1-e.frictionAir*(t/p._baseDelta),r=(e.position.x-e.positionPrev.x)*o,s=(e.position.y-e.positionPrev.y)*o;e.velocity.x=r*i+e.force.x/e.mass*n,e.velocity.y=s*i+e.force.y/e.mass*n,e.positionPrev.x=e.position.x,e.positionPrev.y=e.position.y,e.position.x+=e.velocity.x,e.position.y+=e.velocity.y,e.deltaTime=t,e.angularVelocity=(e.angle-e.anglePrev)*i*o+e.torque/e.inertia*n,e.anglePrev=e.angle,e.angle+=e.angularVelocity;for(var a=0;a<e.parts.length;a++){var l=e.parts[a];u.translate(l.vertices,e.velocity),0<a&&(l.position.x+=e.velocity.x,l.position.y+=e.velocity.y),0!==e.angularVelocity&&(u.rotate(l.vertices,e.angularVelocity,e.position),y.rotate(l.axes,e.angularVelocity),0<a&&d.rotateAbout(l.position,e.angularVelocity,e.position,l.position)),f.update(l.bounds,l.vertices,e.velocity)}},c.updateVelocities=function(e){var t=c._baseDelta/e.deltaTime,n=e.velocity;n.x=(e.position.x-e.positionPrev.x)*t,n.y=(e.position.y-e.positionPrev.y)*t,e.speed=Math.sqrt(n.x*n.x+n.y*n.y),e.angularVelocity=(e.angle-e.anglePrev)*t,e.angularSpeed=Math.abs(e.angularVelocity)},c.applyForce=function(e,t,n){var o=t.x-e.position.x,t=t.y-e.position.y;e.force.x+=n.x,e.force.y+=n.y,e.torque+=o*n.y-t*n.x},c._totalProperties=function(e){for(var t={mass:0,area:0,inertia:0,centre:{x:0,y:0}},n=1===e.parts.length?0:1;n<e.parts.length;n++){var o=e.parts[n],i=o.mass!==1/0?o.mass:1;t.mass+=i,t.area+=o.area,t.inertia+=o.inertia,t.centre=d.add(t.centre,d.mult(o.position,i))}return t.centre=d.div(t.centre,t.mass),t}},function(e,t,n){var o={},u=(e.exports=o,n(0));o.on=function(e,t,n){for(var o,i=t.split(" "),r=0;r<i.length;r++)o=i[r],e.events=e.events||{},e.events[o]=e.events[o]||[],e.events[o].push(n);return n},o.off=function(e,t,n){if(t){"function"==typeof t&&(n=t,t=u.keys(e.events).join(" "));for(var o=t.split(" "),i=0;i<o.length;i++){var r=e.events[o[i]],s=[];if(n&&r)for(var a=0;a<r.length;a++)r[a]!==n&&s.push(r[a]);e.events[o[i]]=s}}else e.events={}},o.trigger=function(e,t,n){var o,i,r,s=e.events;if(s&&0<u.keys(s).length){n=n||{};for(var a=t.split(" "),l=0;l<a.length;l++)if(i=s[o=a[l]]){(r=u.clone(n,!1)).name=o,r.source=e;for(var c=0;c<i.length;c++)i[c].apply(e,[r])}}}},function(e,t,n){var d={},s=(e.exports=d,n(5)),r=n(0),a=n(1),p=n(4);d.create=function(e){return r.extend({id:r.nextId(),type:"composite",parent:null,isModified:!1,bodies:[],constraints:[],composites:[],label:"Composite",plugin:{},cache:{allBodies:null,allConstraints:null,allComposites:null}},e)},d.setModified=function(e,t,n,o){if((e.isModified=t)&&e.cache&&(e.cache.allBodies=null,e.cache.allConstraints=null,e.cache.allComposites=null),n&&e.parent&&d.setModified(e.parent,t,n,o),o)for(var i=0;i<e.composites.length;i++){var r=e.composites[i];d.setModified(r,t,n,o)}},d.add=function(e,t){var n=[].concat(t);s.trigger(e,"beforeAdd",{object:t});for(var o=0;o<n.length;o++){var i=n[o];switch(i.type){case"body":if(i.parent!==i){r.warn("Composite.add: skipped adding a compound body part (you must add its parent instead)");break}d.addBody(e,i);break;case"constraint":d.addConstraint(e,i);break;case"composite":d.addComposite(e,i);break;case"mouseConstraint":d.addConstraint(e,i.constraint)}}return s.trigger(e,"afterAdd",{object:t}),e},d.remove=function(e,t,n){var o=[].concat(t);s.trigger(e,"beforeRemove",{object:t});for(var i=0;i<o.length;i++){var r=o[i];switch(r.type){case"body":d.removeBody(e,r,n);break;case"constraint":d.removeConstraint(e,r,n);break;case"composite":d.removeComposite(e,r,n);break;case"mouseConstraint":d.removeConstraint(e,r.constraint)}}return s.trigger(e,"afterRemove",{object:t}),e},d.addComposite=function(e,t){return e.composites.push(t),t.parent=e,d.setModified(e,!0,!0,!1),e},d.removeComposite=function(e,t,n){var o=r.indexOf(e.composites,t);if(-1!==o&&d.removeCompositeAt(e,o),n)for(var i=0;i<e.composites.length;i++)d.removeComposite(e.composites[i],t,!0);return e},d.removeCompositeAt=function(e,t){return e.composites.splice(t,1),d.setModified(e,!0,!0,!1),e},d.addBody=function(e,t){return e.bodies.push(t),d.setModified(e,!0,!0,!1),e},d.removeBody=function(e,t,n){var o=r.indexOf(e.bodies,t);if(-1!==o&&d.removeBodyAt(e,o),n)for(var i=0;i<e.composites.length;i++)d.removeBody(e.composites[i],t,!0);return e},d.removeBodyAt=function(e,t){return e.bodies.splice(t,1),d.setModified(e,!0,!0,!1),e},d.addConstraint=function(e,t){return e.constraints.push(t),d.setModified(e,!0,!0,!1),e},d.removeConstraint=function(e,t,n){var o=r.indexOf(e.constraints,t);if(-1!==o&&d.removeConstraintAt(e,o),n)for(var i=0;i<e.composites.length;i++)d.removeConstraint(e.composites[i],t,!0);return e},d.removeConstraintAt=function(e,t){return e.constraints.splice(t,1),d.setModified(e,!0,!0,!1),e},d.clear=function(e,t,n){if(n)for(var o=0;o<e.composites.length;o++)d.clear(e.composites[o],t,!0);return t?e.bodies=e.bodies.filter(function(e){return e.isStatic}):e.bodies.length=0,e.constraints.length=0,e.composites.length=0,d.setModified(e,!0,!0,!1),e},d.allBodies=function(e){if(e.cache&&e.cache.allBodies)return e.cache.allBodies;for(var t=[].concat(e.bodies),n=0;n<e.composites.length;n++)t=t.concat(d.allBodies(e.composites[n]));return e.cache&&(e.cache.allBodies=t),t},d.allConstraints=function(e){if(e.cache&&e.cache.allConstraints)return e.cache.allConstraints;for(var t=[].concat(e.constraints),n=0;n<e.composites.length;n++)t=t.concat(d.allConstraints(e.composites[n]));return e.cache&&(e.cache.allConstraints=t),t},d.allComposites=function(e){if(e.cache&&e.cache.allComposites)return e.cache.allComposites;for(var t=[].concat(e.composites),n=0;n<e.composites.length;n++)t=t.concat(d.allComposites(e.composites[n]));return e.cache&&(e.cache.allComposites=t),t},d.get=function(e,t,n){var o;switch(n){case"body":o=d.allBodies(e);break;case"constraint":o=d.allConstraints(e);break;case"composite":o=d.allComposites(e).concat(e)}return!o||0===(n=o.filter(function(e){return e.id.toString()===t.toString()})).length?null:n[0]},d.move=function(e,t,n){return d.remove(e,t),d.add(n,t),e},d.rebase=function(e){for(var t=d.allBodies(e).concat(d.allConstraints(e)).concat(d.allComposites(e)),n=0;n<t.length;n++)t[n].id=r.nextId();return e},d.translate=function(e,t,n){for(var o=n?d.allBodies(e):e.bodies,i=0;i<o.length;i++)p.translate(o[i],t);return e},d.rotate=function(e,t,n,o){for(var i=Math.cos(t),r=Math.sin(t),s=o?d.allBodies(e):e.bodies,a=0;a<s.length;a++){var l=s[a],c=l.position.x-n.x,u=l.position.y-n.y;p.setPosition(l,{x:n.x+(c*i-u*r),y:n.y+(c*r+u*i)}),p.rotate(l,t)}return e},d.scale=function(e,t,n,o,i){for(var r=i?d.allBodies(e):e.bodies,s=0;s<r.length;s++){var a=r[s],l=a.position.x-o.x,c=a.position.y-o.y;p.setPosition(a,{x:o.x+l*t,y:o.y+c*n}),p.scale(a,t,n)}return e},d.bounds=function(e){for(var t=d.allBodies(e),n=[],o=0;o<t.length;o+=1){var i=t[o];n.push(i.bounds.min,i.bounds.max)}return a.create(n)}},function(e,t,n){var l={},c=(e.exports=l,n(4)),o=n(5),u=n(0);l._motionWakeThreshold=.18,l._motionSleepThreshold=.08,l._minBias=.9,l.update=function(e,t){for(var n=t/u._baseDelta,o=l._motionSleepThreshold,i=0;i<e.length;i++){var r=e[i],s=c.getSpeed(r),a=c.getAngularSpeed(r),s=s*s+a*a;0===r.force.x&&0===r.force.y?(a=Math.min(r.motion,s),s=Math.max(r.motion,s),r.motion=l._minBias*a+(1-l._minBias)*s,0<r.sleepThreshold&&r.motion<o?(r.sleepCounter+=1,r.sleepCounter>=r.sleepThreshold/n&&l.set(r,!0)):0<r.sleepCounter&&--r.sleepCounter):l.set(r,!1)}},l.afterCollisions=function(e){for(var t=l._motionSleepThreshold,n=0;n<e.length;n++){var o,i,r=e[n];r.isActive&&(o=(r=r.collision).bodyA.parent,r=r.bodyB.parent,o.isSleeping&&r.isSleeping||o.isStatic||r.isStatic||!o.isSleeping&&!r.isSleeping||!(i=o.isSleeping&&!o.isStatic?o:r).isStatic&&(i===o?r:o).motion>t&&l.set(i,!1))}},l.set=function(e,t){var n=e.isSleeping;t?(e.isSleeping=!0,e.sleepCounter=e.sleepThreshold,e.positionImpulse.x=0,e.positionImpulse.y=0,e.positionPrev.x=e.position.x,e.positionPrev.y=e.position.y,e.anglePrev=e.angle,e.speed=0,e.angularSpeed=0,e.motion=0,n||o.trigger(e,"sleepStart")):(e.isSleeping=!1,e.sleepCounter=0,n&&o.trigger(e,"sleepEnd"))}},function(e,t,n){var l={};e.exports=l;var c=n(3),u=n(9),v=[],d={overlap:0,axis:null},p={overlap:0,axis:null};l.create=function(e,t){return{pair:null,collided:!1,bodyA:e,bodyB:t,parentA:e.parent,parentB:t.parent,depth:0,normal:{x:0,y:0},tangent:{x:0,y:0},penetration:{x:0,y:0},supports:[]}},l.collides=function(e,t,n){if(l._overlapAxes(d,e.vertices,t.vertices,e.axes),d.overlap<=0)return null;if(l._overlapAxes(p,t.vertices,e.vertices,t.axes),p.overlap<=0)return null;var o,i,n=n&&n.table[u.id(e,t)],n=(n?o=n.collision:((o=l.create(e,t)).collided=!0,o.bodyA=e.id<t.id?e:t,o.bodyB=e.id<t.id?t:e,o.parentA=o.bodyA.parent,o.parentB=o.bodyB.parent),e=o.bodyA,t=o.bodyB,o.normal),r=o.supports,s=(i=d.overlap<p.overlap?d:p).axis,a=s.x,s=s.y,a=(a*(t.position.x-e.position.x)+s*(t.position.y-e.position.y)<0?(n.x=a,n.y=s):(n.x=-a,n.y=-s),o.tangent.x=-n.y,o.tangent.y=n.x,o.depth=i.overlap,o.penetration.x=n.x*o.depth,o.penetration.y=n.y*o.depth,l._findSupports(e,t,n,1)),s=0;return c.contains(e.vertices,a[0])&&(r[s++]=a[0]),c.contains(e.vertices,a[1])&&(r[s++]=a[1]),s<2&&(i=l._findSupports(t,e,n,-1),c.contains(t.vertices,i[0])&&(r[s++]=i[0]),s<2&&c.contains(t.vertices,i[1])&&(r[s++]=i[1])),0===s&&(r[s++]=a[0]),r.length=s,o},l._overlapAxes=function(e,t,n,o){for(var i,r,s=t.length,a=n.length,l=t[0].x,c=t[0].y,u=n[0].x,d=n[0].y,p=o.length,f=Number.MAX_VALUE,y=0,v=0;v<p;v++){for(var m=o[v],g=m.x,x=m.y,h=l*g+c*x,b=u*g+d*x,S=h,w=b,A=1;A<s;A+=1)(r=t[A].x*g+t[A].y*x)>S?S=r:r<h&&(h=r);for(A=1;A<a;A+=1)(r=n[A].x*g+n[A].y*x)>w?w=r:r<b&&(b=r);if((m=(m=S-b)<(i=w-h)?m:i)<f&&(y=v,(f=m)<=0))break}e.axis=o[y],e.overlap=f},l._projectToAxis=function(e,t,n){for(var o=t[0].x*n.x+t[0].y*n.y,i=o,r=1;r<t.length;r+=1){var s=t[r].x*n.x+t[r].y*n.y;i<s?i=s:s<o&&(o=s)}e.min=o,e.max=i},l._findSupports=function(e,t,n,o){for(var i,r,s,a=t.vertices,l=a.length,c=e.position.x,u=e.position.y,d=n.x*o,p=n.y*o,f=Number.MAX_VALUE,y=0;y<l;y+=1)(s=d*(c-(r=a[y]).x)+p*(u-r.y))<f&&(f=s,i=r);return f=d*(c-(t=a[(l+i.index-1)%l]).x)+p*(u-t.y),d*(c-(r=a[(i.index+1)%l]).x)+p*(u-r.y)<f?(v[0]=i,v[1]=r):(v[0]=i,v[1]=t),v}},function(e,t,n){var i={},f=(e.exports=i,n(16));i.create=function(e,t){var n=e.bodyA,o=e.bodyB,n={id:i.id(n,o),bodyA:n,bodyB:o,collision:e,contacts:[],activeContacts:[],separation:0,isActive:!0,confirmedActive:!0,isSensor:n.isSensor||o.isSensor,timeCreated:t,timeUpdated:t,inverseMass:0,friction:0,frictionStatic:0,restitution:0,slop:0};return i.update(n,e,t),n},i.update=function(e,t,n){var o=e.contacts,i=t.supports,r=e.activeContacts,s=t.parentA,a=t.parentB,l=s.vertices.length;e.isActive=!0,e.timeUpdated=n,e.collision=t,e.separation=t.depth,e.inverseMass=s.inverseMass+a.inverseMass,e.friction=(s.friction<a.friction?s:a).friction,e.frictionStatic=(s.frictionStatic>a.frictionStatic?s:a).frictionStatic,e.restitution=(s.restitution>a.restitution?s:a).restitution,e.slop=(s.slop>a.slop?s:a).slop,t.pair=e;for(var c=r.length=0;c<i.length;c++){var u=i[c],d=u.body===s?u.index:l+u.index,p=o[d];p?r.push(p):r.push(o[d]=f.create(u))}},i.setActive=function(e,t,n){t?(e.isActive=!0,e.timeUpdated=n):(e.isActive=!1,e.activeContacts.length=0)},i.id=function(e,t){return e.id<t.id?"A"+e.id+"B"+t.id:"A"+t.id+"B"+e.id}},function(e,t,n){var v={},s=(e.exports=v,n(3)),m=n(2),a=n(7),l=n(1),c=n(11),u=n(0);v._warming=.4,v._torqueDampen=1,v._minLength=1e-6,v.create=function(e){e.bodyA&&!e.pointA&&(e.pointA={x:0,y:0}),e.bodyB&&!e.pointB&&(e.pointB={x:0,y:0});var t=e.bodyA?m.add(e.bodyA.position,e.pointA):e.pointA,n=e.bodyB?m.add(e.bodyB.position,e.pointB):e.pointB,t=m.magnitude(m.sub(t,n)),n=(e.length=void 0!==e.length?e.length:t,e.id=e.id||u.nextId(),e.label=e.label||"Constraint",e.type="constraint",e.stiffness=e.stiffness||(0<e.length?1:.7),e.damping=e.damping||0,e.angularStiffness=e.angularStiffness||0,e.angleA=e.bodyA?e.bodyA.angle:e.angleA,e.angleB=e.bodyB?e.bodyB.angle:e.angleB,e.plugin={},{visible:!0,lineWidth:2,strokeStyle:"#ffffff",type:"line",anchors:!0});return 0===e.length&&.1<e.stiffness?(n.type="pin",n.anchors=!1):e.stiffness<.9&&(n.type="spring"),e.render=u.extend(n,e.render),e},v.preSolveAll=function(e){for(var t=0;t<e.length;t+=1){var n=e[t],o=n.constraintImpulse;n.isStatic||0===o.x&&0===o.y&&0===o.angle||(n.position.x+=o.x,n.position.y+=o.y,n.angle+=o.angle)}},v.solveAll=function(e,t){for(var n=u.clamp(t/u._baseDelta,0,1),o=0;o<e.length;o+=1){var i=e[o],r=!i.bodyA||i.bodyA&&i.bodyA.isStatic,s=!i.bodyB||i.bodyB&&i.bodyB.isStatic;(r||s)&&v.solve(e[o],n)}for(o=0;o<e.length;o+=1)r=!(i=e[o]).bodyA||i.bodyA&&i.bodyA.isStatic,s=!i.bodyB||i.bodyB&&i.bodyB.isStatic,r||s||v.solve(e[o],n)},v.solve=function(e,t){var n,o,i,r,s,a,l,c,u,d=e.bodyA,p=e.bodyB,f=e.pointA,y=e.pointB;(d||p)&&(d&&!d.isStatic&&(m.rotate(f,d.angle-e.angleA,f),e.angleA=d.angle),p&&!p.isStatic&&(m.rotate(y,p.angle-e.angleB,y),e.angleB=p.angle),c=f,n=y,d&&(c=m.add(d.position,f)),p&&(n=m.add(p.position,y)),c&&n&&(c=m.sub(c,n),r=((n=(n=m.magnitude(c))<v._minLength?v._minLength:n)-e.length)/n,s=1<=e.stiffness||0===e.length?e.stiffness*t:e.stiffness*t*t,t=e.damping*t,r=m.mult(c,r*s),a=(s=(d?d.inverseMass:0)+(p?p.inverseMass:0))+((d?d.inverseInertia:0)+(p?p.inverseInertia:0)),0<t&&(u=m.create(),l=m.div(c,n),c=m.sub(p&&m.sub(p.position,p.positionPrev)||u,d&&m.sub(d.position,d.positionPrev)||u),u=m.dot(l,c)),d&&!d.isStatic&&(i=d.inverseMass/s,d.constraintImpulse.x-=r.x*i,d.constraintImpulse.y-=r.y*i,d.position.x-=r.x*i,d.position.y-=r.y*i,0<t&&(d.positionPrev.x-=t*l.x*u*i,d.positionPrev.y-=t*l.y*u*i),o=m.cross(f,r)/a*v._torqueDampen*d.inverseInertia*(1-e.angularStiffness),d.constraintImpulse.angle-=o,d.angle-=o),p&&!p.isStatic&&(i=p.inverseMass/s,p.constraintImpulse.x+=r.x*i,p.constraintImpulse.y+=r.y*i,p.position.x+=r.x*i,p.position.y+=r.y*i,0<t&&(p.positionPrev.x+=t*l.x*u*i,p.positionPrev.y+=t*l.y*u*i),o=m.cross(y,r)/a*v._torqueDampen*p.inverseInertia*(1-e.angularStiffness),p.constraintImpulse.angle+=o,p.angle+=o)))},v.postSolveAll=function(e){for(var t=0;t<e.length;t++){var n=e[t],o=n.constraintImpulse;if(!(n.isStatic||0===o.x&&0===o.y&&0===o.angle)){a.set(n,!1);for(var i=0;i<n.parts.length;i++){var r=n.parts[i];s.translate(r.vertices,o),0<i&&(r.position.x+=o.x,r.position.y+=o.y),0!==o.angle&&(s.rotate(r.vertices,o.angle,n.position),c.rotate(r.axes,o.angle),0<i&&m.rotateAbout(r.position,o.angle,n.position,r.position)),l.update(r.bounds,r.vertices,n.velocity)}o.angle*=v._warming,o.x*=v._warming,o.y*=v._warming}}},v.pointAWorld=function(e){return{x:(e.bodyA?e.bodyA.position.x:0)+(e.pointA?e.pointA.x:0),y:(e.bodyA?e.bodyA.position.y:0)+(e.pointA?e.pointA.y:0)}},v.pointBWorld=function(e){return{x:(e.bodyB?e.bodyB.position.x:0)+(e.pointB?e.pointB.x:0),y:(e.bodyB?e.bodyB.position.y:0)+(e.pointB?e.pointB.y:0)}}},function(e,t,n){var o={},i=(e.exports=o,n(2)),r=n(0);o.fromVertices=function(e){for(var t={},n=0;n<e.length;n++){var o=(n+1)%e.length,o=i.normalise({x:e[o].y-e[n].y,y:e[n].x-e[o].x});t[(0===o.y?1/0:o.x/o.y).toFixed(3).toString()]=o}return r.values(t)},o.rotate=function(e,t){if(0!==t)for(var n=Math.cos(t),o=Math.sin(t),i=0;i<e.length;i++){var r=e[i],s=r.x*n-r.y*o;r.y=r.x*o+r.y*n,r.x=s}}},function(e,t,n){var d={},M=(e.exports=d,n(3)),B=n(0),_=n(4),k=n(1),I=n(2);d.rectangle=function(e,t,n,o,i){i=i||{};e={label:"Rectangle Body",position:{x:e,y:t},vertices:M.fromPath("L 0 0 L "+n+" 0 L "+n+" "+o+" L 0 "+o)};return i.chamfer&&(t=i.chamfer,e.vertices=M.chamfer(e.vertices,t.radius,t.quality,t.qualityMin,t.qualityMax),delete i.chamfer),_.create(B.extend({},e,i))},d.trapezoid=function(e,t,n,o,i,r){r=r||{};var s=n*(i*=.5),n=s+(1-2*i)*n,a=n+s,e={label:"Trapezoid Body",position:{x:e,y:t},vertices:M.fromPath(i<.5?"L 0 0 L "+s+" "+-o+" L "+n+" "+-o+" L "+a+" 0":"L 0 0 L "+n+" "+-o+" L "+a+" 0")};return r.chamfer&&(t=r.chamfer,e.vertices=M.chamfer(e.vertices,t.radius,t.quality,t.qualityMin,t.qualityMax),delete r.chamfer),_.create(B.extend({},e,r))},d.circle=function(e,t,n,o,i){o=o||{};var r={label:"Circle Body",circleRadius:n},i=(i=i||25,Math.ceil(Math.max(10,Math.min(i,n))));return i%2==1&&(i+=1),d.polygon(e,t,i,n,B.extend({},r,o))},d.polygon=function(e,t,n,o,i){if(i=i||{},n<3)return d.circle(e,t,o,i);for(var r=2*Math.PI/n,s="",a=.5*r,l=0;l<n;l+=1){var c=a+l*r,u=Math.cos(c)*o,c=Math.sin(c)*o;s+="L "+u.toFixed(3)+" "+c.toFixed(3)+" "}e={label:"Polygon Body",position:{x:e,y:t},vertices:M.fromPath(s)};return i.chamfer&&(t=i.chamfer,e.vertices=M.chamfer(e.vertices,t.radius,t.quality,t.qualityMin,t.qualityMax),delete i.chamfer),_.create(B.extend({},e,i))},d.fromVertices=function(e,t,n,o,i,r,s,a){var l,c,u,d,p=B.getDecomp(),f=Boolean(p&&p.quickDecomp);for(o=o||{},l=[],i=void 0!==i&&i,r=void 0!==r?r:.01,s=void 0!==s?s:10,a=void 0!==a?a:.01,B.isArray(n[0])||(n=[n]),u=0;u<n.length;u+=1)if(c=n[u],(y=M.isConvex(c))||f||B.warnOnce("Bodies.fromVertices: Install the 'poly-decomp' library and use Common.setDecomp or provide 'decomp' as a global to decompose concave vertices."),y||!f)c=y?M.clockwiseSort(c):M.hull(c),l.push({position:{x:e,y:t},vertices:c});else for(var y=c.map(function(e){return[e.x,e.y]}),v=(p.makeCCW(y),!1!==r&&p.removeCollinearPoints(y,r),!1!==a&&p.removeDuplicatePoints&&p.removeDuplicatePoints(y,a),p.quickDecomp(y)),m=0;m<v.length;m++){var g=v[m].map(function(e){return{x:e[0],y:e[1]}});0<s&&M.area(g)<s||l.push({position:M.centre(g),vertices:g})}for(m=0;m<l.length;m++)l[m]=_.create(B.extend(l[m],o));if(i)for(m=0;m<l.length;m++)for(var x=l[m],h=m+1;h<l.length;h++){var b=l[h];if(k.overlaps(x.bounds,b.bounds))for(var S=x.vertices,w=b.vertices,A=0;A<x.vertices.length;A++)for(d=0;d<b.vertices.length;d++){var P=I.magnitudeSquared(I.sub(S[(A+1)%S.length],w[d])),C=I.magnitudeSquared(I.sub(S[A],w[(d+1)%w.length]));P<5&&C<5&&(S[A].isInternal=!0,w[d].isInternal=!0)}}return 1<l.length?(i=_.create(B.extend({parts:l.slice(0)},o)),_.setPosition(i,{x:e,y:t}),i):l[0]}},function(e,t,n){var M={},o=(e.exports=M,n(0)),B=n(8);M.create=function(e){return o.extend({bodies:[],pairs:null},e)},M.setBodies=function(e,t){e.bodies=t.slice(0)},M.clear=function(e){e.bodies=[]},M.collisions=function(e){var t,n=[],o=e.pairs,i=e.bodies,r=i.length,s=M.canCollide,a=B.collides;for(i.sort(M._compareBoundsX),t=0;t<r;t++)for(var l,c=i[t],u=(c.bounds,c.bounds.max.x),d=c.bounds.max.y,p=c.bounds.min.y,f=c.isStatic||c.isSleeping,y=c.parts.length,v=1===y,m=t+1;m<r;m++){var g=i[m];if((C=g.bounds).min.x>u)break;if(!(d<C.min.y||p>C.max.y)&&(!f||!g.isStatic&&!g.isSleeping)&&s(c.collisionFilter,g.collisionFilter)){var x=g.parts.length;if(v&&1===x)(A=a(c,g,o))&&n.push(A);else for(var h=1<x?1:0,b=1<y?1:0;b<y;b++)for(var S=c.parts[b],w=(l=S.bounds,h);w<x;w++){var A,P=g.parts[w],C=P.bounds;l.min.x>C.max.x||l.max.x<C.min.x||l.max.y<C.min.y||l.min.y>C.max.y||(A=a(S,P,o))&&n.push(A)}}}return n},M.canCollide=function(e,t){return e.group===t.group&&0!==e.group?0<e.group:0!=(e.mask&t.category)&&0!=(t.mask&e.category)},M._compareBoundsX=function(e,t){return e.bounds.min.x-t.bounds.min.x}},function(e,t,n){var o={},i=(e.exports=o,n(0));o.create=function(e){var n={};return e||i.log("Mouse.create: element was undefined, defaulting to document.body","warn"),n.element=e||document.body,n.absolute={x:0,y:0},n.position={x:0,y:0},n.mousedownPosition={x:0,y:0},n.mouseupPosition={x:0,y:0},n.offset={x:0,y:0},n.scale={x:1,y:1},n.wheelDelta=0,n.button=-1,n.pixelRatio=parseInt(n.element.getAttribute("data-pixel-ratio"),10)||1,n.sourceEvents={mousemove:null,mousedown:null,mouseup:null,mousewheel:null},n.mousemove=function(e){var t=o._getRelativeMousePosition(e,n.element,n.pixelRatio);e.changedTouches&&(n.button=0,e.preventDefault()),n.absolute.x=t.x,n.absolute.y=t.y,n.position.x=n.absolute.x*n.scale.x+n.offset.x,n.position.y=n.absolute.y*n.scale.y+n.offset.y,n.sourceEvents.mousemove=e},n.mousedown=function(e){var t=o._getRelativeMousePosition(e,n.element,n.pixelRatio);e.changedTouches?(n.button=0,e.preventDefault()):n.button=e.button,n.absolute.x=t.x,n.absolute.y=t.y,n.position.x=n.absolute.x*n.scale.x+n.offset.x,n.position.y=n.absolute.y*n.scale.y+n.offset.y,n.mousedownPosition.x=n.position.x,n.mousedownPosition.y=n.position.y,n.sourceEvents.mousedown=e},n.mouseup=function(e){var t=o._getRelativeMousePosition(e,n.element,n.pixelRatio);e.changedTouches&&e.preventDefault(),n.button=-1,n.absolute.x=t.x,n.absolute.y=t.y,n.position.x=n.absolute.x*n.scale.x+n.offset.x,n.position.y=n.absolute.y*n.scale.y+n.offset.y,n.mouseupPosition.x=n.position.x,n.mouseupPosition.y=n.position.y,n.sourceEvents.mouseup=e},n.mousewheel=function(e){n.wheelDelta=Math.max(-1,Math.min(1,e.wheelDelta||-e.detail)),e.preventDefault()},o.setElement(n,n.element),n},o.setElement=function(e,t){(e.element=t).addEventListener("mousemove",e.mousemove),t.addEventListener("mousedown",e.mousedown),t.addEventListener("mouseup",e.mouseup),t.addEventListener("mousewheel",e.mousewheel),t.addEventListener("DOMMouseScroll",e.mousewheel),t.addEventListener("touchmove",e.mousemove),t.addEventListener("touchstart",e.mousedown),t.addEventListener("touchend",e.mouseup)},o.clearSourceEvents=function(e){e.sourceEvents.mousemove=null,e.sourceEvents.mousedown=null,e.sourceEvents.mouseup=null,e.sourceEvents.mousewheel=null,e.wheelDelta=0},o.setOffset=function(e,t){e.offset.x=t.x,e.offset.y=t.y,e.position.x=e.absolute.x*e.scale.x+e.offset.x,e.position.y=e.absolute.y*e.scale.y+e.offset.y},o.setScale=function(e,t){e.scale.x=t.x,e.scale.y=t.y,e.position.x=e.absolute.x*e.scale.x+e.offset.x,e.position.y=e.absolute.y*e.scale.y+e.offset.y},o._getRelativeMousePosition=function(e,t,n){var o,i=t.getBoundingClientRect(),r=document.documentElement||document.body.parentNode||document.body,s=void 0!==window.pageXOffset?window.pageXOffset:r.scrollLeft,r=void 0!==window.pageYOffset?window.pageYOffset:r.scrollTop,a=e.changedTouches,a=a?(o=a[0].pageX-i.left-s,a[0].pageY-i.top-r):(o=e.pageX-i.left-s,e.pageY-i.top-r);return{x:o/(t.clientWidth/(t.width||t.clientWidth)*n),y:a/(t.clientHeight/(t.height||t.clientHeight)*n)}}},function(e,t,n){var s={},a=(e.exports=s,n(0));s._registry={},s.register=function(e){var t,n,o;return s.isPlugin(e)||a.warn("Plugin.register:",s.toString(e),"does not implement all required fields."),e.name in s._registry?(t=s._registry[e.name],n=s.versionParse(e.version).number,(o=s.versionParse(t.version).number)<n?(a.warn("Plugin.register:",s.toString(t),"was upgraded to",s.toString(e)),s._registry[e.name]=e):n<o?a.warn("Plugin.register:",s.toString(t),"can not be downgraded to",s.toString(e)):e!==t&&a.warn("Plugin.register:",s.toString(e),"is already registered to different plugin object")):s._registry[e.name]=e,e},s.resolve=function(e){return s._registry[s.dependencyParse(e).name]},s.toString=function(e){return"string"==typeof e?e:(e.name||"anonymous")+"@"+(e.version||e.range||"0.0.0")},s.isPlugin=function(e){return e&&e.name&&e.version&&e.install},s.isUsed=function(e,t){return-1<e.used.indexOf(t)},s.isFor=function(e,t){var n=e.for&&s.dependencyParse(e.for);return!e.for||t.name===n.name&&s.versionSatisfies(t.version,n.range)},s.use=function(e,t){if(e.uses=(e.uses||[]).concat(t||[]),0!==e.uses.length){for(var n,t=s.dependencies(e),o=a.topologicalSort(t),i=[],r=0;r<o.length;r+=1)o[r]!==e.name&&((n=s.resolve(o[r]))?s.isUsed(e,n.name)||(s.isFor(n,e)||(a.warn("Plugin.use:",s.toString(n),"is for",n.for,"but installed on",s.toString(e)+"."),n._warned=!0),n.install?n.install(e):(a.warn("Plugin.use:",s.toString(n),"does not specify an install function."),n._warned=!0),n._warned?(i.push("🔶 "+s.toString(n)),delete n._warned):i.push("✅ "+s.toString(n)),e.used.push(n.name)):i.push("❌ "+o[r]));0<i.length&&a.info(i.join("  "))}else a.warn("Plugin.use:",s.toString(e),"does not specify any dependencies to install.")},s.dependencies=function(o,e){var i=s.dependencyParse(o),t=i.name;if(!(t in(e=e||{}))){o=s.resolve(o)||o,e[t]=a.map(o.uses||[],function(e){s.isPlugin(e)&&s.register(e);var t=s.dependencyParse(e),n=s.resolve(e);return n&&!s.versionSatisfies(n.version,t.range)?(a.warn("Plugin.dependencies:",s.toString(n),"does not satisfy",s.toString(t),"used by",s.toString(i)+"."),n._warned=!0,o._warned=!0):n||(a.warn("Plugin.dependencies:",s.toString(e),"used by",s.toString(i),"could not be resolved."),o._warned=!0),t.name});for(var n=0;n<e[t].length;n+=1)s.dependencies(e[t][n],e);return e}},s.dependencyParse=function(e){return a.isString(e)?(/^[\w-]+(@(\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-+]+)?))?$/.test(e)||a.warn("Plugin.dependencyParse:",e,"is not a valid dependency string."),{name:e.split("@")[0],range:e.split("@")[1]||"*"}):{name:e.name,range:e.range||e.version}},s.versionParse=function(e){var t=/^(\*)|(\^|~|>=|>)?\s*((\d+)\.(\d+)\.(\d+))(-[0-9A-Za-z-+]+)?$/,t=(t.test(e)||a.warn("Plugin.versionParse:",e,"is not a valid version or range."),t.exec(e)),n=Number(t[4]),o=Number(t[5]),i=Number(t[6]);return{isRange:Boolean(t[1]||t[2]),version:t[3],range:e,operator:t[1]||t[2]||"",major:n,minor:o,patch:i,parts:[n,o,i],prerelease:t[7],number:1e8*n+1e4*o+i}},s.versionSatisfies=function(e,t){var n=s.versionParse(t=t||"*"),o=s.versionParse(e);if(n.isRange){if("*"===n.operator||"*"===e)return!0;if(">"===n.operator)return o.number>n.number;if(">="===n.operator)return o.number>=n.number;if("~"===n.operator)return o.major===n.major&&o.minor===n.minor&&o.patch>=n.patch;if("^"===n.operator)return 0<n.major?o.major===n.major&&o.number>=n.number:0<n.minor?o.minor===n.minor&&o.patch>=n.patch:o.patch===n.patch}return e===t||"*"===e}},function(e,t){var n={};(e.exports=n).create=function(e){return{vertex:e,normalImpulse:0,tangentImpulse:0}}},function(e,t,n){var p={},f=(e.exports=p,n(7)),y=n(18),v=n(13),m=n(19),g=n(5),x=n(6),h=n(10),b=n(0),r=n(4);p.create=function(e){var t=b.extend({positionIterations:6,velocityIterations:4,constraintIterations:2,enableSleeping:!1,events:[],plugin:{},gravity:{x:0,y:1,scale:.001},timing:{timestamp:0,timeScale:1,lastDelta:0,lastElapsed:0}},e=e||{});return t.world=e.world||x.create({label:"World"}),t.pairs=e.pairs||m.create(),t.detector=e.detector||v.create(),t.grid={buckets:[]},t.world.gravity=t.gravity,t.broadphase=t.grid,t.metrics={},t},p.update=function(e,t){var n,o=b.now(),i=e.world,r=e.detector,s=e.pairs,a=e.timing,l=a.timestamp,a=(t=void 0!==t?t:b._baseDelta,t*=a.timeScale,a.timestamp+=t,a.lastDelta=t,{timestamp:a.timestamp,delta:t}),c=(g.trigger(e,"beforeUpdate",a),x.allBodies(i)),u=x.allConstraints(i);for(i.isModified&&(v.setBodies(r,c),x.setModified(i,!1,!1,!0)),e.enableSleeping&&f.update(c,t),p._bodiesApplyGravity(c,e.gravity),0<t&&p._bodiesUpdate(c,t),h.preSolveAll(c),n=0;n<e.constraintIterations;n++)h.solveAll(u,t);h.postSolveAll(c),r.pairs=e.pairs;var i=v.collisions(r),d=(m.update(s,i,l),e.enableSleeping&&f.afterCollisions(s.list),0<s.collisionStart.length&&g.trigger(e,"collisionStart",{pairs:s.collisionStart}),b.clamp(20/e.positionIterations,0,1));for(y.preSolvePosition(s.list),n=0;n<e.positionIterations;n++)y.solvePosition(s.list,t,d);for(y.postSolvePosition(c),h.preSolveAll(c),n=0;n<e.constraintIterations;n++)h.solveAll(u,t);for(h.postSolveAll(c),y.preSolveVelocity(s.list),n=0;n<e.velocityIterations;n++)y.solveVelocity(s.list,t);return p._bodiesUpdateVelocities(c),0<s.collisionActive.length&&g.trigger(e,"collisionActive",{pairs:s.collisionActive}),0<s.collisionEnd.length&&g.trigger(e,"collisionEnd",{pairs:s.collisionEnd}),p._bodiesClearForces(c),g.trigger(e,"afterUpdate",a),e.timing.lastElapsed=b.now()-o,e},p.merge=function(e,t){if(b.extend(e,t),t.world){e.world=t.world,p.clear(e);for(var n=x.allBodies(e.world),o=0;o<n.length;o++){var i=n[o];f.set(i,!1),i.id=b.nextId()}}},p.clear=function(e){m.clear(e.pairs),v.clear(e.detector)},p._bodiesClearForces=function(e){for(var t=e.length,n=0;n<t;n++){var o=e[n];o.force.x=0,o.force.y=0,o.torque=0}},p._bodiesApplyGravity=function(e,t){var n=void 0!==t.scale?t.scale:.001,o=e.length;if((0!==t.x||0!==t.y)&&0!==n)for(var i=0;i<o;i++){var r=e[i];r.isStatic||r.isSleeping||(r.force.y+=r.mass*t.y*n,r.force.x+=r.mass*t.x*n)}},p._bodiesUpdate=function(e,t){for(var n=e.length,o=0;o<n;o++){var i=e[o];i.isStatic||i.isSleeping||r.update(i,t)}},p._bodiesUpdateVelocities=function(e){for(var t=e.length,n=0;n<t;n++)r.updateVelocities(e[n])}},function(e,t,n){var D={},f=(e.exports=D,n(3)),O=n(0),y=n(1);D._restingThresh=2,D._restingThreshTangent=Math.sqrt(6),D._positionDampen=.9,D._positionWarming=.8,D._frictionNormalMultiplier=5,D._frictionMaxStatic=Number.MAX_VALUE,D.preSolvePosition=function(e){for(var t,n,o=e.length,i=0;i<o;i++)(t=e[i]).isActive&&(n=t.activeContacts.length,t.collision.parentA.totalContacts+=n,t.collision.parentB.totalContacts+=n)},D.solvePosition=function(e,t,n){for(var o,i,r,s,a,l,c,u=D._positionDampen*(n||1),d=O.clamp(t/O._baseDelta,0,1),p=e.length,f=0;f<p;f++)(o=e[f]).isActive&&!o.isSensor&&(r=(i=o.collision).parentA,s=i.parentB,a=i.normal,o.separation=a.x*(s.positionImpulse.x+i.penetration.x-r.positionImpulse.x)+a.y*(s.positionImpulse.y+i.penetration.y-r.positionImpulse.y));for(f=0;f<p;f++)(o=e[f]).isActive&&!o.isSensor&&(r=(i=o.collision).parentA,s=i.parentB,a=i.normal,c=o.separation-o.slop*d,(r.isStatic||s.isStatic)&&(c*=2),r.isStatic||r.isSleeping||(l=u/r.totalContacts,r.positionImpulse.x+=a.x*c*l,r.positionImpulse.y+=a.y*c*l),s.isStatic||s.isSleeping||(l=u/s.totalContacts,s.positionImpulse.x-=a.x*c*l,s.positionImpulse.y-=a.y*c*l))},D.postSolvePosition=function(e){for(var t=D._positionWarming,n=e.length,o=f.translate,i=y.update,r=0;r<n;r++){var s=e[r],a=s.positionImpulse,l=a.x,c=a.y,u=s.velocity;if((s.totalContacts=0)!==l||0!==c){for(var d=0;d<s.parts.length;d++){var p=s.parts[d];o(p.vertices,a),i(p.bounds,p.vertices,u),p.position.x+=l,p.position.y+=c}s.positionPrev.x+=l,s.positionPrev.y+=c,l*u.x+c*u.y<0?(a.x=0,a.y=0):(a.x*=t,a.y*=t)}}},D.preSolveVelocity=function(e){for(var t=e.length,n=0;n<t;n++){var o=e[n];if(o.isActive&&!o.isSensor)for(var i=o.activeContacts,r=i.length,o=o.collision,s=o.parentA,a=o.parentB,l=o.normal,c=o.tangent,u=0;u<r;u++){var d,p=i[u],f=p.vertex,y=p.normalImpulse,p=p.tangentImpulse;0===y&&0===p||(d=l.x*y+c.x*p,y=l.y*y+c.y*p,s.isStatic||s.isSleeping||(s.positionPrev.x+=d*s.inverseMass,s.positionPrev.y+=y*s.inverseMass,s.anglePrev+=s.inverseInertia*((f.x-s.position.x)*y-(f.y-s.position.y)*d)),a.isStatic||a.isSleeping||(a.positionPrev.x-=d*a.inverseMass,a.positionPrev.y-=y*a.inverseMass,a.anglePrev-=a.inverseInertia*((f.x-a.position.x)*y-(f.y-a.position.y)*d)))}}},D.solveVelocity=function(e,t){for(var n,o,i,t=t/O._baseDelta,r=t*t*t,s=-D._restingThresh*t,a=D._restingThreshTangent,l=D._frictionNormalMultiplier*t,c=D._frictionMaxStatic,u=e.length,d=0;d<u;d++){var p=e[d];if(p.isActive&&!p.isSensor){var f=p.collision,y=f.parentA,v=f.parentB,m=y.velocity,g=v.velocity,x=f.normal.x,h=f.normal.y,b=f.tangent.x,S=f.tangent.y,w=p.activeContacts,A=w.length,P=1/A,C=y.inverseMass+v.inverseMass,M=p.friction*p.frictionStatic*l;for(m.x=y.position.x-y.positionPrev.x,m.y=y.position.y-y.positionPrev.y,g.x=v.position.x-v.positionPrev.x,g.y=v.position.y-v.positionPrev.y,y.angularVelocity=y.angle-y.anglePrev,v.angularVelocity=v.angle-v.anglePrev,i=0;i<A;i++){var B=w[i],_=B.vertex,k=_.x-y.position.x,I=_.y-y.position.y,T=_.x-v.position.x,_=_.y-v.position.y,R=m.x-I*y.angularVelocity,V=m.y+k*y.angularVelocity,R=R-(g.x-_*v.angularVelocity),V=V-(g.y+T*v.angularVelocity),E=x*R+h*V,R=b*R+S*V,V=p.separation+E,L=Math.min(V,1),V=(L=V<0?0:L)*M,L=(R<-V||V<R?(n=p.friction*(0<R?1:-1)*r)<-(o=0<R?R:-R)?n=-o:o<n&&(n=o):(n=R,o=c),k*h-I*x),V=T*h-_*x,L=P/(C+y.inverseInertia*L*L+v.inverseInertia*V*V),V=(1+p.restitution)*E*L,L=(n*=L,E<s?B.normalImpulse=0:(L=B.normalImpulse,B.normalImpulse+=V,0<B.normalImpulse&&(B.normalImpulse=0),V=B.normalImpulse-L),R<-a||a<R?B.tangentImpulse=0:(E=B.tangentImpulse,B.tangentImpulse+=n,B.tangentImpulse<-o&&(B.tangentImpulse=-o),B.tangentImpulse>o&&(B.tangentImpulse=o),n=B.tangentImpulse-E),x*V+b*n),R=h*V+S*n;y.isStatic||y.isSleeping||(y.positionPrev.x+=L*y.inverseMass,y.positionPrev.y+=R*y.inverseMass,y.anglePrev+=(k*R-I*L)*y.inverseInertia),v.isStatic||v.isSleeping||(v.positionPrev.x-=L*v.inverseMass,v.positionPrev.y-=R*v.inverseMass,v.anglePrev-=(T*R-_*L)*v.inverseInertia)}}}}},function(e,t,n){var o={},v=(e.exports=o,n(9)),i=n(0);o.create=function(e){return i.extend({table:{},list:[],collisionStart:[],collisionActive:[],collisionEnd:[]},e)},o.update=function(e,t,n){var o,i,r,s=e.list,a=s.length,l=e.table,c=t.length,u=e.collisionStart,d=e.collisionEnd,p=e.collisionActive;for(u.length=0,d.length=0,y=p.length=0;y<a;y++)s[y].confirmedActive=!1;for(y=0;y<c;y++)(r=(o=t[y]).pair)?((r.isActive?p:u).push(r),v.update(r,o,n),r.confirmedActive=!0):(l[(r=v.create(o,n)).id]=r,u.push(r),s.push(r));for(var f=[],a=s.length,y=0;y<a;y++)(r=s[y]).confirmedActive||(v.setActive(r,!1,n),d.push(r),r.collision.bodyA.isSleeping||r.collision.bodyB.isSleeping||f.push(y));for(y=0;y<f.length;y++)r=s[i=f[y]-y],s.splice(i,1),delete l[r.id]},o.clear=function(e){return e.table={},e.list.length=0,e.collisionStart.length=0,e.collisionActive.length=0,e.collisionEnd.length=0,e}},function(e,t,n){e=e.exports=n(21);e.Axes=n(11),e.Bodies=n(12),e.Body=n(4),e.Bounds=n(1),e.Collision=n(8),e.Common=n(0),e.Composite=n(6),e.Composites=n(22),e.Constraint=n(10),e.Contact=n(16),e.Detector=n(13),e.Engine=n(17),e.Events=n(5),e.Grid=n(23),e.Mouse=n(14),e.MouseConstraint=n(24),e.Pair=n(9),e.Pairs=n(19),e.Plugin=n(15),e.Query=n(25),e.Render=n(26),e.Resolver=n(18),e.Runner=n(27),e.SAT=n(28),e.Sleeping=n(7),e.Svg=n(29),e.Vector=n(2),e.Vertices=n(3),e.World=n(30),e.Engine.run=e.Runner.run,e.Common.deprecated(e.Engine,"run","Engine.run ➤ use Matter.Runner.run(engine) instead")},function(e,t,n){var o={},i=(e.exports=o,n(15)),r=n(0);o.name="matter-js",o.version="0.19.0",o.uses=[],o.used=[],o.use=function(){i.use(o,Array.prototype.slice.call(arguments))},o.before=function(e,t){return e=e.replace(/^Matter./,""),r.chainPathBefore(o,e,t)},o.after=function(e,t){return e=e.replace(/^Matter./,""),r.chainPathAfter(o,e,t)}},function(e,t,n){var f={},x=(e.exports=f,n(6)),y=n(10),v=n(0),h=n(4),u=n(12),e=v.deprecated;f.stack=function(e,t,n,o,i,r,s){for(var a,l=x.create({label:"Stack"}),c=e,u=t,d=0,p=0;p<o;p++){for(var f=0,y=0;y<n;y++){var v,m,g=s(c,u,y,p,a,d);g?(v=g.bounds.max.y-g.bounds.min.y,m=g.bounds.max.x-g.bounds.min.x,f<v&&(f=v),h.translate(g,{x:.5*m,y:.5*v}),c=g.bounds.max.x+i,x.addBody(l,g),a=g,d+=1):c+=i}u+=f+r,c=e}return l},f.chain=function(e,t,n,o,i,r){for(var s=e.bodies,a=1;a<s.length;a++){var l=s[a-1],c=s[a],u=l.bounds.max.y-l.bounds.min.y,d=l.bounds.max.x-l.bounds.min.x,p=c.bounds.max.y-c.bounds.min.y,l={bodyA:l,pointA:{x:d*t,y:u*n},bodyB:c,pointB:{x:(c.bounds.max.x-c.bounds.min.x)*o,y:p*i}},d=v.extend(l,r);x.addConstraint(e,y.create(d))}return e.label+=" Chain",e},f.mesh=function(e,t,n,o,i){for(var r,s,a,l,c=e.bodies,u=0;u<n;u++){for(r=1;r<t;r++)s=c[r-1+u*t],a=c[r+u*t],x.addConstraint(e,y.create(v.extend({bodyA:s,bodyB:a},i)));if(0<u)for(r=0;r<t;r++)s=c[r+(u-1)*t],a=c[r+u*t],x.addConstraint(e,y.create(v.extend({bodyA:s,bodyB:a},i))),o&&0<r&&(l=c[r-1+(u-1)*t],x.addConstraint(e,y.create(v.extend({bodyA:l,bodyB:a},i)))),o&&r<t-1&&(l=c[r+1+(u-1)*t],x.addConstraint(e,y.create(v.extend({bodyA:l,bodyB:a},i))))}return e.label+=" Mesh",e},f.pyramid=function(l,e,c,u,d,t,p){return f.stack(l,e,c,u,d,t,function(e,t,n,o,i,r){var s=Math.min(u,Math.ceil(c/2)),a=i?i.bounds.max.x-i.bounds.min.x:0;if(!(s<o||n<(o=s-o)||c-1-o<n))return 1===r&&h.translate(i,{x:(n+(c%2==1?1:-1))*a,y:0}),p(l+(i?n*a:0)+n*d,t,n,o,i,r)})},f.newtonsCradle=function(e,t,n,o,i){for(var r=x.create({label:"Newtons Cradle"}),s=0;s<n;s++){var a=u.circle(e+s*(1.9*o),t+i,o,{inertia:1/0,restitution:1,friction:0,frictionAir:1e-4,slop:1}),l=y.create({pointA:{x:e+s*(1.9*o),y:t},bodyB:a});x.addBody(r,a),x.addConstraint(r,l)}return r},e(f,"newtonsCradle","Composites.newtonsCradle ➤ moved to newtonsCradle example"),f.car=function(e,t,n,o,i){var r=h.nextGroup(!0),s=.5*-n+20,a=.5*n-20,l=x.create({label:"Car"}),n=u.rectangle(e,t,n,o,{collisionFilter:{group:r},chamfer:{radius:.5*o},density:2e-4}),o=u.circle(e+s,t+0,i,{collisionFilter:{group:r},friction:.8}),e=u.circle(e+a,t+0,i,{collisionFilter:{group:r},friction:.8}),t=y.create({bodyB:n,pointB:{x:s,y:0},bodyA:o,stiffness:1,length:0}),i=y.create({bodyB:n,pointB:{x:a,y:0},bodyA:e,stiffness:1,length:0});return x.addBody(l,n),x.addBody(l,o),x.addBody(l,e),x.addConstraint(l,t),x.addConstraint(l,i),l},e(f,"car","Composites.car ➤ moved to car example"),f.softBody=function(e,t,n,o,i,r,s,a,l,c){l=v.extend({inertia:1/0},l),c=v.extend({stiffness:.2,render:{type:"line",anchors:!1}},c);e=f.stack(e,t,n,o,i,r,function(e,t){return u.circle(e,t,a,l)});return f.mesh(e,n,o,s,c),e.label="Soft Body",e},e(f,"softBody","Composites.softBody ➤ moved to softBody and cloth examples")},function(e,t,n){var g={},u=(e.exports=g,n(9)),l=n(0),e=l.deprecated;g.create=function(e){return l.extend({buckets:{},pairs:{},pairsList:[],bucketWidth:48,bucketHeight:48},e)},g.update=function(e,t,n,o){for(var i,r,s=n.world,a=e.buckets,l=!1,c=0;c<t.length;c++){var u=t[c];if((!u.isSleeping||o)&&(!s.bounds||!(u.bounds.max.x<s.bounds.min.x||u.bounds.min.x>s.bounds.max.x||u.bounds.max.y<s.bounds.min.y||u.bounds.min.y>s.bounds.max.y))){var d=g._getRegion(e,u);if(!u.region||d.id!==u.region.id||o){u.region&&!o||(u.region=d);for(var p=g._regionUnion(d,u.region),f=p.startCol;f<=p.endCol;f++)for(i=p.startRow;i<=p.endRow;i++){var y=a[r=g._getBucketId(f,i)],v=f>=d.startCol&&f<=d.endCol&&i>=d.startRow&&i<=d.endRow,m=f>=u.region.startCol&&f<=u.region.endCol&&i>=u.region.startRow&&i<=u.region.endRow;!v&&m&&m&&y&&g._bucketRemoveBody(e,y,u),(u.region===d||v&&!m||o)&&(y=y||g._createBucket(a,r),g._bucketAddBody(e,y,u))}u.region=d,l=!0}}}l&&(e.pairsList=g._createActivePairsList(e))},e(g,"update","Grid.update ➤ replaced by Matter.Detector"),g.clear=function(e){e.buckets={},e.pairs={},e.pairsList=[]},e(g,"clear","Grid.clear ➤ replaced by Matter.Detector"),g._regionUnion=function(e,t){var n=Math.min(e.startCol,t.startCol),o=Math.max(e.endCol,t.endCol),i=Math.min(e.startRow,t.startRow),e=Math.max(e.endRow,t.endRow);return g._createRegion(n,o,i,e)},g._getRegion=function(e,t){var t=t.bounds,n=Math.floor(t.min.x/e.bucketWidth),o=Math.floor(t.max.x/e.bucketWidth),i=Math.floor(t.min.y/e.bucketHeight),t=Math.floor(t.max.y/e.bucketHeight);return g._createRegion(n,o,i,t)},g._createRegion=function(e,t,n,o){return{id:e+","+t+","+n+","+o,startCol:e,endCol:t,startRow:n,endRow:o}},g._getBucketId=function(e,t){return"C"+e+"R"+t},g._createBucket=function(e,t){return e[t]=[]},g._bucketAddBody=function(e,t,n){for(var o=e.pairs,i=u.id,r=t.length,s=0;s<r;s++){var a,l,c=t[s];n.id===c.id||n.isStatic&&c.isStatic||((l=o[a=i(n,c)])?l[2]+=1:o[a]=[n,c,1])}t.push(n)},g._bucketRemoveBody=function(e,t,n){for(var o=e.pairs,i=u.id,r=(t.splice(l.indexOf(t,n),1),t.length),s=0;s<r;s++){var a=o[i(n,t[s])];a&&--a[2]}},g._createActivePairsList=function(e){for(var t,n=e.pairs,o=l.keys(n),i=o.length,r=[],s=0;s<i;s++)0<(t=n[o[s]])[2]?r.push(t):delete n[o[s]];return r}},function(e,t,n){var i={},l=(e.exports=i,n(3)),c=n(7),r=n(14),u=n(5),d=n(13),s=n(10),a=n(6),p=n(0),f=n(1);i.create=function(t,e){var n=(t?t.mouse:null)||(e?e.mouse:null),n=(n||(t&&t.render&&t.render.canvas?n=r.create(t.render.canvas):e&&e.element?n=r.create(e.element):(n=r.create(),p.warn("MouseConstraint.create: options.mouse was undefined, options.element was undefined, may not function as expected"))),{type:"mouseConstraint",mouse:n,element:null,body:null,constraint:s.create({label:"Mouse Constraint",pointA:n.position,pointB:{x:0,y:0},length:.01,stiffness:.1,angularStiffness:1,render:{strokeStyle:"#90EE90",lineWidth:3}}),collisionFilter:{category:1,mask:4294967295,group:0}}),o=p.extend(n,e);return u.on(t,"beforeUpdate",function(){var e=a.allBodies(t.world);i.update(o,e),i._triggerEvents(o)}),o},i.update=function(e,t){var n=e.mouse,o=e.constraint,i=e.body;if(0===n.button){if(o.bodyB)c.set(o.bodyB,!1),o.pointA=n.position;else for(var r=0;r<t.length;r++)if(i=t[r],f.contains(i.bounds,n.position)&&d.canCollide(i.collisionFilter,e.collisionFilter))for(var s=1<i.parts.length?1:0;s<i.parts.length;s++){var a=i.parts[s];if(l.contains(a.vertices,n.position)){o.pointA=n.position,o.bodyB=e.body=i,o.pointB={x:n.position.x-i.position.x,y:n.position.y-i.position.y},o.angleB=i.angle,c.set(i,!1),u.trigger(e,"startdrag",{mouse:n,body:i});break}}}else o.bodyB=e.body=null,o.pointB=null,i&&u.trigger(e,"enddrag",{mouse:n,body:i})},i._triggerEvents=function(e){var t=e.mouse,n=t.sourceEvents;n.mousemove&&u.trigger(e,"mousemove",{mouse:t}),n.mousedown&&u.trigger(e,"mousedown",{mouse:t}),n.mouseup&&u.trigger(e,"mouseup",{mouse:t}),r.clearSourceEvents(t)}},function(e,t,n){var u={},d=(e.exports=u,n(2)),f=n(8),y=n(1),p=n(12),a=n(3);u.collides=function(e,t){for(var n=[],o=t.length,i=e.bounds,r=f.collides,s=y.overlaps,a=0;a<o;a++){var l=t[a],c=l.parts.length,u=1===c?0:1;if(s(l.bounds,i))for(var d=u;d<c;d++){var p=l.parts[d];if(s(p.bounds,i)){p=r(p,e);if(p){n.push(p);break}}}}return n},u.ray=function(e,t,n,o){o=o||1e-100;for(var i=d.angle(t,n),r=d.magnitude(d.sub(t,n)),s=.5*(n.x+t.x),n=.5*(n.y+t.y),t=p.rectangle(s,n,r,o,{angle:i}),a=u.collides(t,e),l=0;l<a.length;l+=1){var c=a[l];c.body=c.bodyB=c.bodyA}return a},u.region=function(e,t,n){for(var o=[],i=0;i<e.length;i++){var r=e[i],s=y.overlaps(r.bounds,t);(s&&!n||!s&&n)&&o.push(r)}return o},u.point=function(e,t){for(var n=[],o=0;o<e.length;o++){var i=e[o];if(y.contains(i.bounds,t))for(var r=1===i.parts.length?0:1;r<i.parts.length;r++){var s=i.parts[r];if(y.contains(s.bounds,t)&&a.contains(s.vertices,t)){n.push(i);break}}}return n}},function(e,t,n){var o,i,r,f,s,a,y,S,w={},l=(e.exports=w,n(4)),A=n(0),P=n(6),C=n(1),M=n(5),B=n(2),_=n(14);"undefined"!=typeof window&&(o=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(function(){e(A.now())},1e3/60)},i=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),w._goodFps=30,w._goodDelta=1e3/60,w.create=function(e){var t={engine:null,element:null,canvas:null,mouse:null,frameRequestId:null,timing:{historySize:60,delta:0,deltaHistory:[],lastTime:0,lastTimestamp:0,lastElapsed:0,timestampElapsed:0,timestampElapsedHistory:[],engineDeltaHistory:[],engineElapsedHistory:[],elapsedHistory:[]},options:{width:800,height:600,pixelRatio:1,background:"#14151f",wireframeBackground:"#14151f",hasBounds:!!e.bounds,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showStats:!1,showPerformance:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showSeparations:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showVertexNumbers:!1,showConvexHulls:!1,showInternalEdges:!1,showMousePosition:!1}},t=A.extend(t,e);return t.canvas&&(t.canvas.width=t.options.width||t.canvas.width,t.canvas.height=t.options.height||t.canvas.height),t.mouse=e.mouse,t.engine=e.engine,t.canvas=t.canvas||s(t.options.width,t.options.height),t.context=t.canvas.getContext("2d"),t.textures={},t.bounds=t.bounds||{min:{x:0,y:0},max:{x:t.canvas.width,y:t.canvas.height}},t.controller=w,t.options.showBroadphase=!1,1!==t.options.pixelRatio&&w.setPixelRatio(t,t.options.pixelRatio),A.isElement(t.element)&&t.element.appendChild(t.canvas),t},w.run=function(n){!function e(t){n.frameRequestId=o(e),r(n,t),w.world(n,t),(n.options.showStats||n.options.showDebug)&&w.stats(n,n.context,t),(n.options.showPerformance||n.options.showDebug)&&w.performance(n,n.context,t)}()},w.stop=function(e){i(e.frameRequestId)},w.setPixelRatio=function(e,t){var n=e.options,e=e.canvas;"auto"===t&&(t=a(e)),n.pixelRatio=t,e.setAttribute("data-pixel-ratio",t),e.width=n.width*t,e.height=n.height*t,e.style.width=n.width+"px",e.style.height=n.height+"px"},w.lookAt=function(e,t,n,o){o=void 0===o||o,t=A.isArray(t)?t:[t],n=n||{x:0,y:0};for(var i={min:{x:1/0,y:1/0},max:{x:-1/0,y:-1/0}},r=0;r<t.length;r+=1){var s=t[r],a=s.bounds?s.bounds.min:s.min||s.position||s,s=s.bounds?s.bounds.max:s.max||s.position||s;a&&s&&(a.x<i.min.x&&(i.min.x=a.x),s.x>i.max.x&&(i.max.x=s.x),a.y<i.min.y&&(i.min.y=a.y),s.y>i.max.y&&(i.max.y=s.y))}var l=i.max.x-i.min.x+2*n.x,c=i.max.y-i.min.y+2*n.y,u=e.canvas.height,u=e.canvas.width/u,d=l/c,p=1,f=1;u<d?f=d/u:p=u/d,e.options.hasBounds=!0,e.bounds.min.x=i.min.x,e.bounds.max.x=i.min.x+l*p,e.bounds.min.y=i.min.y,e.bounds.max.y=i.min.y+c*f,o&&(e.bounds.min.x+=.5*l-l*p*.5,e.bounds.max.x+=.5*l-l*p*.5,e.bounds.min.y+=.5*c-c*f*.5,e.bounds.max.y+=.5*c-c*f*.5),e.bounds.min.x-=n.x,e.bounds.max.x-=n.x,e.bounds.min.y-=n.y,e.bounds.max.y-=n.y,e.mouse&&(_.setScale(e.mouse,{x:(e.bounds.max.x-e.bounds.min.x)/e.canvas.width,y:(e.bounds.max.y-e.bounds.min.y)/e.canvas.height}),_.setOffset(e.mouse,e.bounds.min))},w.startViewTransform=function(e){var t=e.bounds.max.x-e.bounds.min.x,n=e.bounds.max.y-e.bounds.min.y,t=t/e.options.width,n=n/e.options.height;e.context.setTransform(e.options.pixelRatio/t,0,0,e.options.pixelRatio/n,0,0),e.context.translate(-e.bounds.min.x,-e.bounds.min.y)},w.endViewTransform=function(e){e.context.setTransform(e.options.pixelRatio,0,0,e.options.pixelRatio,0,0)},w.world=function(e,t){var n,o=A.now(),i=e.engine,r=i.world,s=e.canvas,a=e.context,l=e.options,c=e.timing,u=P.allBodies(r),d=P.allConstraints(r),r=l.wireframes?l.wireframeBackground:l.background,p=[],f=[],y={timestamp:i.timing.timestamp};if(M.trigger(e,"beforeRender",y),e.currentBackground!==r&&S(e,r),a.globalCompositeOperation="source-in",a.fillStyle="transparent",a.fillRect(0,0,s.width,s.height),a.globalCompositeOperation="source-over",l.hasBounds){for(n=0;n<u.length;n++){var v=u[n];C.overlaps(v.bounds,e.bounds)&&p.push(v)}for(n=0;n<d.length;n++){var m=d[n],g=m.bodyA,x=m.bodyB,h=m.pointA,b=m.pointB;g&&(h=B.add(g.position,m.pointA)),x&&(b=B.add(x.position,m.pointB)),h&&b&&(C.contains(e.bounds,h)||C.contains(e.bounds,b))&&f.push(m)}w.startViewTransform(e),e.mouse&&(_.setScale(e.mouse,{x:(e.bounds.max.x-e.bounds.min.x)/e.options.width,y:(e.bounds.max.y-e.bounds.min.y)/e.options.height}),_.setOffset(e.mouse,e.bounds.min))}else f=d,p=u,1!==e.options.pixelRatio&&e.context.setTransform(e.options.pixelRatio,0,0,e.options.pixelRatio,0,0);!l.wireframes||i.enableSleeping&&l.showSleeping?w.bodies(e,p,a):(l.showConvexHulls&&w.bodyConvexHulls(e,p,a),w.bodyWireframes(e,p,a)),l.showBounds&&w.bodyBounds(e,p,a),(l.showAxes||l.showAngleIndicator)&&w.bodyAxes(e,p,a),l.showPositions&&w.bodyPositions(e,p,a),l.showVelocity&&w.bodyVelocity(e,p,a),l.showIds&&w.bodyIds(e,p,a),l.showSeparations&&w.separations(e,i.pairs.list,a),l.showCollisions&&w.collisions(e,i.pairs.list,a),l.showVertexNumbers&&w.vertexNumbers(e,p,a),l.showMousePosition&&w.mousePosition(e,e.mouse,a),w.constraints(f,a),l.hasBounds&&w.endViewTransform(e),M.trigger(e,"afterRender",y),c.lastElapsed=A.now()-o},w.stats=function(e,t,n){for(var e=e.engine,o=e.world,i=P.allBodies(o),r=0,s=0,a=0;a<i.length;a+=1)r+=i[a].parts.length;var l,c={Part:r,Body:i.length,Cons:P.allConstraints(o).length,Comp:P.allComposites(o).length,Pair:e.pairs.list.length};for(l in t.fillStyle="#0e0f19",t.fillRect(s,0,302.5,44),t.font="12px Arial",t.textBaseline="top",t.textAlign="right",c){var u=c[l];t.fillStyle="#aaa",t.fillText(l,s+55,8),t.fillStyle="#eee",t.fillText(u,s+55,26),s+=55}},w.performance=function(e,t){var n=e.engine,e=e.timing,o=e.deltaHistory,i=e.elapsedHistory,r=e.timestampElapsedHistory,s=e.engineDeltaHistory,a=e.engineElapsedHistory,e=n.timing.lastDelta,l=f(o),c=f(i),u=f(s),d=f(a),p=f(r)/l||0,n=1e3/l||0;t.fillStyle="#0e0f19",t.fillRect(0,50,370,34),w.status(t,10,69,60,4,o.length,Math.round(n)+" fps",n/w._goodFps,function(e){return o[e]/l-1}),w.status(t,82,69,60,4,s.length,e.toFixed(2)+" dt",w._goodDelta/e,function(e){return s[e]/u-1}),w.status(t,154,69,60,4,a.length,d.toFixed(2)+" ut",1-d/w._goodFps,function(e){return a[e]/d-1}),w.status(t,226,69,60,4,i.length,c.toFixed(2)+" rt",1-c/w._goodFps,function(e){return i[e]/c-1}),w.status(t,298,69,60,4,r.length,p.toFixed(2)+" x",p*p*p,function(e){return(r[e]/o[e]/p||0)-1})},w.status=function(e,t,n,o,i,r,s,a,l){e.strokeStyle="#888",e.fillStyle="#444",e.lineWidth=1,e.fillRect(t,n+7,o,1),e.beginPath(),e.moveTo(t,n+7-i*A.clamp(.4*l(0),-2,2));for(var c=0;c<o;c+=1)e.lineTo(t+c,n+7-(c<r?i*A.clamp(.4*l(c),-2,2):0));e.stroke(),e.fillStyle="hsl("+A.clamp(25+95*a,0,120)+",100%,60%)",e.fillRect(t,n-7,4,4),e.font="12px Arial",e.textBaseline="middle",e.textAlign="right",e.fillStyle="#eee",e.fillText(s,t+o,n-5)},w.constraints=function(e,t){for(var n=t,o=0;o<e.length;o++){var i=e[o];if(i.render.visible&&i.pointA&&i.pointB){var r,s=i.bodyA,a=i.bodyB,l=s?B.add(s.position,i.pointA):i.pointA;if("pin"===i.render.type)n.beginPath(),n.arc(l.x,l.y,3,0,2*Math.PI),n.closePath();else{if(r=a?B.add(a.position,i.pointB):i.pointB,n.beginPath(),n.moveTo(l.x,l.y),"spring"===i.render.type)for(var c,u=B.sub(r,l),d=B.perp(B.normalise(u)),p=Math.ceil(A.clamp(i.length/5,12,20)),f=1;f<p;f+=1)n.lineTo(l.x+u.x*(f/p)+d.x*(c=f%2==0?1:-1)*4,l.y+u.y*(f/p)+d.y*c*4);n.lineTo(r.x,r.y)}i.render.lineWidth&&(n.lineWidth=i.render.lineWidth,n.strokeStyle=i.render.strokeStyle,n.stroke()),i.render.anchors&&(n.fillStyle=i.render.strokeStyle,n.beginPath(),n.arc(l.x,l.y,3,0,2*Math.PI),n.arc(r.x,r.y,3,0,2*Math.PI),n.closePath(),n.fill())}}},w.bodies=function(e,t,n){for(var o,i,r,s=n,a=(e.engine,e.options),l=a.showInternalEdges||!a.wireframes,c=0;c<t.length;c++)if((o=t[c]).render.visible)for(r=1<o.parts.length?1:0;r<o.parts.length;r++)if((i=o.parts[r]).render.visible){if(a.showSleeping&&o.isSleeping?s.globalAlpha=.5*i.render.opacity:1!==i.render.opacity&&(s.globalAlpha=i.render.opacity),i.render.sprite&&i.render.sprite.texture&&!a.wireframes){var u=i.render.sprite,d=y(e,u.texture);s.translate(i.position.x,i.position.y),s.rotate(i.angle),s.drawImage(d,d.width*-u.xOffset*u.xScale,d.height*-u.yOffset*u.yScale,d.width*u.xScale,d.height*u.yScale),s.rotate(-i.angle),s.translate(-i.position.x,-i.position.y)}else{if(i.circleRadius)s.beginPath(),s.arc(i.position.x,i.position.y,i.circleRadius,0,2*Math.PI);else{s.beginPath(),s.moveTo(i.vertices[0].x,i.vertices[0].y);for(var p=1;p<i.vertices.length;p++)!i.vertices[p-1].isInternal||l?s.lineTo(i.vertices[p].x,i.vertices[p].y):s.moveTo(i.vertices[p].x,i.vertices[p].y),i.vertices[p].isInternal&&!l&&s.moveTo(i.vertices[(p+1)%i.vertices.length].x,i.vertices[(p+1)%i.vertices.length].y);s.lineTo(i.vertices[0].x,i.vertices[0].y),s.closePath()}a.wireframes?(s.lineWidth=1,s.strokeStyle="#bbb",s.stroke()):(s.fillStyle=i.render.fillStyle,i.render.lineWidth&&(s.lineWidth=i.render.lineWidth,s.strokeStyle=i.render.strokeStyle,s.stroke()),s.fill())}s.globalAlpha=1}},w.bodyWireframes=function(e,t,n){var o,i,r,s,a,l=n,c=e.options.showInternalEdges;for(l.beginPath(),r=0;r<t.length;r++)if((o=t[r]).render.visible)for(a=1<o.parts.length?1:0;a<o.parts.length;a++){for(i=o.parts[a],l.moveTo(i.vertices[0].x,i.vertices[0].y),s=1;s<i.vertices.length;s++)!i.vertices[s-1].isInternal||c?l.lineTo(i.vertices[s].x,i.vertices[s].y):l.moveTo(i.vertices[s].x,i.vertices[s].y),i.vertices[s].isInternal&&!c&&l.moveTo(i.vertices[(s+1)%i.vertices.length].x,i.vertices[(s+1)%i.vertices.length].y);l.lineTo(i.vertices[0].x,i.vertices[0].y)}l.lineWidth=1,l.strokeStyle="#bbb",l.stroke()},w.bodyConvexHulls=function(e,t,n){var o,i,r,s=n;for(s.beginPath(),i=0;i<t.length;i++)if((o=t[i]).render.visible&&1!==o.parts.length){for(s.moveTo(o.vertices[0].x,o.vertices[0].y),r=1;r<o.vertices.length;r++)s.lineTo(o.vertices[r].x,o.vertices[r].y);s.lineTo(o.vertices[0].x,o.vertices[0].y)}s.lineWidth=1,s.strokeStyle="rgba(255,255,255,0.2)",s.stroke()},w.vertexNumbers=function(e,t,n){for(var o=n,i=0;i<t.length;i++)for(var r=t[i].parts,s=1<r.length?1:0;s<r.length;s++)for(var a=r[s],l=0;l<a.vertices.length;l++)o.fillStyle="rgba(255,255,255,0.2)",o.fillText(i+"_"+l,a.position.x+.8*(a.vertices[l].x-a.position.x),a.position.y+.8*(a.vertices[l].y-a.position.y))},w.mousePosition=function(e,t,n){n.fillStyle="rgba(255,255,255,0.8)",n.fillText(t.position.x+"  "+t.position.y,t.position.x+5,t.position.y-5)},w.bodyBounds=function(e,t,n){var o=n,n=(e.engine,e.options);o.beginPath();for(var i=0;i<t.length;i++)if(t[i].render.visible)for(var r=t[i].parts,s=1<r.length?1:0;s<r.length;s++){var a=r[s];o.rect(a.bounds.min.x,a.bounds.min.y,a.bounds.max.x-a.bounds.min.x,a.bounds.max.y-a.bounds.min.y)}n.wireframes?o.strokeStyle="rgba(255,255,255,0.08)":o.strokeStyle="rgba(0,0,0,0.1)",o.lineWidth=1,o.stroke()},w.bodyAxes=function(e,t,n){var o,i,r,s,a=n,l=(e.engine,e.options);for(a.beginPath(),i=0;i<t.length;i++){var c=t[i],u=c.parts;if(c.render.visible)if(l.showAxes)for(r=1<u.length?1:0;r<u.length;r++)for(o=u[r],s=0;s<o.axes.length;s++){var d=o.axes[s];a.moveTo(o.position.x,o.position.y),a.lineTo(o.position.x+20*d.x,o.position.y+20*d.y)}else for(r=1<u.length?1:0;r<u.length;r++)for(o=u[r],s=0;s<o.axes.length;s++)a.moveTo(o.position.x,o.position.y),a.lineTo((o.vertices[0].x+o.vertices[o.vertices.length-1].x)/2,(o.vertices[0].y+o.vertices[o.vertices.length-1].y)/2)}l.wireframes?(a.strokeStyle="indianred",a.lineWidth=1):(a.strokeStyle="rgba(255, 255, 255, 0.4)",a.globalCompositeOperation="overlay",a.lineWidth=2),a.stroke(),a.globalCompositeOperation="source-over"},w.bodyPositions=function(e,t,n){var o,i,r,s,a=n,n=(e.engine,e.options);for(a.beginPath(),r=0;r<t.length;r++)if((o=t[r]).render.visible)for(s=0;s<o.parts.length;s++)i=o.parts[s],a.arc(i.position.x,i.position.y,3,0,2*Math.PI,!1),a.closePath();for(n.wireframes?a.fillStyle="indianred":a.fillStyle="rgba(0,0,0,0.5)",a.fill(),a.beginPath(),r=0;r<t.length;r++)(o=t[r]).render.visible&&(a.arc(o.positionPrev.x,o.positionPrev.y,2,0,2*Math.PI,!1),a.closePath());a.fillStyle="rgba(255,165,0,0.8)",a.fill()},w.bodyVelocity=function(e,t,n){var o=n;o.beginPath();for(var i=0;i<t.length;i++){var r,s=t[i];s.render.visible&&(r=l.getVelocity(s),o.moveTo(s.position.x,s.position.y),o.lineTo(s.position.x+r.x,s.position.y+r.y))}o.lineWidth=3,o.strokeStyle="cornflowerblue",o.stroke()},w.bodyIds=function(e,t,n){for(var o=n,i=0;i<t.length;i++)if(t[i].render.visible)for(var r=t[i].parts,s=1<r.length?1:0;s<r.length;s++){var a=r[s];o.font="12px Arial",o.fillStyle="rgba(255,255,255,0.5)",o.fillText(a.id,a.position.x+10,a.position.y-10)}},w.collisions=function(e,t,n){var o,i,r,s,a,l,c=n,n=e.options;for(c.beginPath(),r=0;r<t.length;r++)if((o=t[r]).isActive)for(i=o.collision,s=0;s<o.activeContacts.length;s++){var u=o.activeContacts[s].vertex;c.rect(u.x-1.5,u.y-1.5,3.5,3.5)}for(n.wireframes?c.fillStyle="rgba(255,255,255,0.7)":c.fillStyle="orange",c.fill(),c.beginPath(),r=0;r<t.length;r++)(o=t[r]).isActive&&(i=o.collision,0<o.activeContacts.length)&&(a=o.activeContacts[0].vertex.x,l=o.activeContacts[0].vertex.y,2===o.activeContacts.length&&(a=(o.activeContacts[0].vertex.x+o.activeContacts[1].vertex.x)/2,l=(o.activeContacts[0].vertex.y+o.activeContacts[1].vertex.y)/2),i.bodyB===i.supports[0].body||!0===i.bodyA.isStatic?c.moveTo(a-8*i.normal.x,l-8*i.normal.y):c.moveTo(a+8*i.normal.x,l+8*i.normal.y),c.lineTo(a,l));n.wireframes?c.strokeStyle="rgba(255,165,0,0.7)":c.strokeStyle="orange",c.lineWidth=1,c.stroke()},w.separations=function(e,t,n){var o,i,r,s,a,l=n,n=e.options;for(l.beginPath(),r=0;r<t.length;r++)(o=t[r]).isActive&&(s=(o=o.collision).bodyA,a=1,(i=o.bodyB).isStatic||s.isStatic||(a=.5),i.isStatic&&(a=0),l.moveTo(i.position.x,i.position.y),l.lineTo(i.position.x-o.penetration.x*a,i.position.y-o.penetration.y*a),a=1,i.isStatic||s.isStatic||(a=.5),s.isStatic&&(a=0),l.moveTo(s.position.x,s.position.y),l.lineTo(s.position.x+o.penetration.x*a,s.position.y+o.penetration.y*a));n.wireframes?l.strokeStyle="rgba(255,165,0,0.5)":l.strokeStyle="orange",l.stroke()},w.inspector=function(e,t){e.engine;var n,o,i,r=e.selected,s=e.render,a=s.options;a.hasBounds&&(o=s.bounds.max.x-s.bounds.min.x,i=s.bounds.max.y-s.bounds.min.y,o=o/s.options.width,i=i/s.options.height,t.scale(1/o,1/i),t.translate(-s.bounds.min.x,-s.bounds.min.y));for(var l=0;l<r.length;l++){var c=r[l].data;switch(t.translate(.5,.5),t.lineWidth=1,t.strokeStyle="rgba(255,165,0,0.9)",t.setLineDash([1,2]),c.type){case"body":n=c.bounds,t.beginPath(),t.rect(Math.floor(n.min.x-3),Math.floor(n.min.y-3),Math.floor(n.max.x-n.min.x+6),Math.floor(n.max.y-n.min.y+6)),t.closePath(),t.stroke();break;case"constraint":var u=c.pointA;c.bodyA&&(u=c.pointB),t.beginPath(),t.arc(u.x,u.y,10,0,2*Math.PI),t.closePath(),t.stroke()}t.setLineDash([]),t.translate(-.5,-.5)}null!==e.selectStart&&(t.translate(.5,.5),t.lineWidth=1,t.strokeStyle="rgba(255,165,0,0.6)",t.fillStyle="rgba(255,165,0,0.1)",n=e.selectBounds,t.beginPath(),t.rect(Math.floor(n.min.x),Math.floor(n.min.y),Math.floor(n.max.x-n.min.x),Math.floor(n.max.y-n.min.y)),t.closePath(),t.stroke(),t.fill(),t.translate(-.5,-.5)),a.hasBounds&&t.setTransform(1,0,0,1,0,0)},r=function(e,t){var n=e.engine,e=e.timing,o=e.historySize,i=n.timing.timestamp;e.delta=t-e.lastTime||w._goodDelta,e.lastTime=t,e.timestampElapsed=i-e.lastTimestamp||0,e.lastTimestamp=i,e.deltaHistory.unshift(e.delta),e.deltaHistory.length=Math.min(e.deltaHistory.length,o),e.engineDeltaHistory.unshift(n.timing.lastDelta),e.engineDeltaHistory.length=Math.min(e.engineDeltaHistory.length,o),e.timestampElapsedHistory.unshift(e.timestampElapsed),e.timestampElapsedHistory.length=Math.min(e.timestampElapsedHistory.length,o),e.engineElapsedHistory.unshift(n.timing.lastElapsed),e.engineElapsedHistory.length=Math.min(e.engineElapsedHistory.length,o),e.elapsedHistory.unshift(e.lastElapsed),e.elapsedHistory.length=Math.min(e.elapsedHistory.length,o)},f=function(e){for(var t=0,n=0;n<e.length;n+=1)t+=e[n];return t/e.length||0},s=function(e,t){var n=document.createElement("canvas");return n.width=e,n.height=t,n.oncontextmenu=function(){return!1},n.onselectstart=function(){return!1},n},a=function(e){e=e.getContext("2d");return(window.devicePixelRatio||1)/(e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1)},y=function(e,t){var n=e.textures[t];return n||((n=e.textures[t]=new Image).src=t,n)},S=function(e,t){var n=t;/(jpg|gif|png)$/.test(t)&&(n="url("+t+")"),e.canvas.style.background=n,e.canvas.style.backgroundSize="contain",e.currentBackground=t}},function(e,t,n){var i,o,r,s={},a=(e.exports=s,n(5)),l=n(17),c=n(0);"undefined"!=typeof window&&(i=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame,o=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),i||(i=function(e){r=setTimeout(function(){e(c.now())},1e3/60)},o=function(){clearTimeout(r)}),s.create=function(e){e=c.extend({fps:60,deltaSampleSize:60,counterTimestamp:0,frameCounter:0,deltaHistory:[],timePrev:null,frameRequestId:null,isFixed:!1,enabled:!0},e);return e.delta=e.delta||1e3/e.fps,e.deltaMin=e.deltaMin||1e3/e.fps,e.deltaMax=e.deltaMax||1e3/(.5*e.fps),e.fps=1e3/e.delta,e},s.run=function(n,o){return void 0!==n.positionIterations&&(o=n,n=s.create()),function e(t){n.frameRequestId=i(e),t&&n.enabled&&s.tick(n,o,t)}(),n},s.tick=function(e,t,n){var o,i=t.timing,i=(e.isFixed?o=e.delta:(o=n-e.timePrev||e.delta,e.timePrev=n,e.deltaHistory.push(o),e.deltaHistory=e.deltaHistory.slice(-e.deltaSampleSize),o=(o=(o=Math.min.apply(null,e.deltaHistory))<e.deltaMin?e.deltaMin:o)>e.deltaMax?e.deltaMax:o,e.delta=o),{timestamp:i.timestamp});a.trigger(e,"beforeTick",i),e.frameCounter+=1,1e3<=n-e.counterTimestamp&&(e.fps=e.frameCounter*((n-e.counterTimestamp)/1e3),e.counterTimestamp=n,e.frameCounter=0),a.trigger(e,"tick",i),a.trigger(e,"beforeUpdate",i),l.update(t,o),a.trigger(e,"afterUpdate",i),a.trigger(e,"afterTick",i)},s.stop=function(e){o(e.frameRequestId)},s.start=function(e,t){s.run(e,t)}},function(e,t,n){var o={},i=(e.exports=o,n(8)),e=n(0).deprecated;o.collides=function(e,t){return i.collides(e,t)},e(o,"collides","SAT.collides ➤ replaced by Collision.collides")},function(e,t,n){var h={},b=(e.exports=h,n(1),n(0));h.pathToVertices=function(e,t){"undefined"==typeof window||"SVGPathSeg"in window||b.warn("Svg.pathToVertices: SVGPathSeg not defined, a polyfill is required.");function n(e,t,n){var o,n=n%2==1&&1<n;p&&e==p.x&&t==p.y||(y=p&&n?(f=p.x,p.y):f=0,o={x:f+e,y:y+t},!n&&p||(p=o),v.push(o),g=f+e,x=y+t)}function o(e){var t=e.pathSegTypeAsLetter.toUpperCase();if("Z"!==t){switch(t){case"M":case"L":case"T":case"C":case"S":case"Q":g=e.x,x=e.y;break;case"H":g=e.x;break;case"V":x=e.y}n(g,x,e.pathSegType)}}var i,r,s,a,l,c,u,d,p,f,y,v=[],m=0,g=0,x=0;t=t||15;for(h._svgPathToAbsolute(e),s=e.getTotalLength(),c=[],i=0;i<e.pathSegList.numberOfItems;i+=1)c.push(e.pathSegList.getItem(i));for(u=c.concat();m<s;){if((l=c[e.getPathSegAtLength(m)])!=d){for(;u.length&&u[0]!=l;)o(u.shift());d=l}switch(l.pathSegTypeAsLetter.toUpperCase()){case"C":case"T":case"S":case"Q":case"A":a=e.getPointAtLength(m),n(a.x,a.y,0)}m+=t}for(i=0,r=u.length;i<r;++i)o(u[i]);return v},h._svgPathToAbsolute=function(e){for(var t,n,o,i,r,s,a=e.pathSegList,l=0,c=0,u=a.numberOfItems,d=0;d<u;++d){var p=a.getItem(d),f=p.pathSegTypeAsLetter;if(/[MLHVCSQTA]/.test(f))"x"in p&&(l=p.x),"y"in p&&(c=p.y);else switch("x1"in p&&(o=l+p.x1),"x2"in p&&(r=l+p.x2),"y1"in p&&(i=c+p.y1),"y2"in p&&(s=c+p.y2),"x"in p&&(l+=p.x),"y"in p&&(c+=p.y),f){case"m":a.replaceItem(e.createSVGPathSegMovetoAbs(l,c),d);break;case"l":a.replaceItem(e.createSVGPathSegLinetoAbs(l,c),d);break;case"h":a.replaceItem(e.createSVGPathSegLinetoHorizontalAbs(l),d);break;case"v":a.replaceItem(e.createSVGPathSegLinetoVerticalAbs(c),d);break;case"c":a.replaceItem(e.createSVGPathSegCurvetoCubicAbs(l,c,o,i,r,s),d);break;case"s":a.replaceItem(e.createSVGPathSegCurvetoCubicSmoothAbs(l,c,r,s),d);break;case"q":a.replaceItem(e.createSVGPathSegCurvetoQuadraticAbs(l,c,o,i),d);break;case"t":a.replaceItem(e.createSVGPathSegCurvetoQuadraticSmoothAbs(l,c),d);break;case"a":a.replaceItem(e.createSVGPathSegArcAbs(l,c,p.r1,p.r2,p.angle,p.largeArcFlag,p.sweepFlag),d);break;case"z":case"Z":l=t,c=n}"M"!=f&&"m"!=f||(t=l,n=c)}}},function(e,t,n){var o={},e=(e.exports=o,n(6));n(0),o.create=e.create,o.add=e.add,o.remove=e.remove,o.clear=e.clear,o.addComposite=e.addComposite,o.addBody=e.addBody,o.addConstraint=e.addConstraint}],o={},i.m=n,i.c=o,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(n,o,function(e){return t[e]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=20);function i(e){if(o[e])return o[e].exports;var t=o[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,i),t.l=!0,t.exports}var n,o});