<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5"><meta name="theme-color" content="#000000"><link rel="manifest" href="/manifest.json"><script src="/sw-register.js"></script><meta name="description" content="If you&#39;re like me and don&#39;t like the &quot;bloat&quot; of the official docker client, or simply want to try new things and tinker with new methods, then you&#39;re welcome to read this post. Since the blogger is us"><meta property="og:type" content="article"><meta property="og:title" content="Lightweight docker installation for macOS environment"><meta property="og:url" content="https://vccv.cc/en/article/docker-macos.html"><meta property="og:site_name" content="Yuesir"><meta property="og:description" content="If you&#39;re like me and don&#39;t like the &quot;bloat&quot; of the official docker client, or simply want to try new things and tinker with new methods, then you&#39;re welcome to read this post. Since the blogger is us"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://vccv.cc/en/article/docker-macos/image-20221205160750680.png"><meta property="og:image" content="https://vccv.cc/en/article/docker-macos/image-20221213120548391.png"><meta property="og:image" content="https://vccv.cc/en/article/docker-macos/image-20221213121901639.png"><meta property="og:image" content="https://vccv.cc/en/article/docker-macos/image-20221205160832483.png"><meta property="og:image" content="https://vccv.cc/en/article/docker-macos/image-20221205153421353.png"><meta property="article:published_time" content="2022-11-05T04:49:31.000Z"><meta property="article:modified_time" content="2023-01-19T08:56:21.000Z"><meta property="article:author" content="Yuesir"><meta property="article:tag" content="macos"><meta property="article:tag" content="docker"><meta property="article:tag" content="colima"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://vccv.cc/en/article/docker-macos/image-20221205160750680.png"><link rel="shortcut icon" href="/en/images/favicon.ico"><link rel="icon" type="image/png" href="/en/images/favicon-192x192.png" sizes="192x192"><link rel="apple-touch-icon" sizes="180x180" href="/en/images/apple-touch-icon.png"><title>Lightweight docker installation for macOS environment｜Yuesir</title><link rel="stylesheet" href="/en/css/style.css"><link rel="stylesheet" href="/en/css/style-dark.css"><script src="/en/js/switch.js"></script><link rel="stylesheet" href="/en/css/fancybox.css"><meta name="generator" content="Hexo 5.4.2"><link rel="alternate" href="/en/atom.xml" title="Yuesir" type="application/atom+xml">
</head><body class="max-width mx-auto px3 ltr"><div id="header-post"><a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/en/">Home</a></li><li><a href="/en/tags">Tag</a></li><li><a href="/en/search">Search</a></li><li><a href="/en/tools">Tool</a></li><li><a href="/en/about">About</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" aria-label="Previous post" href="/en/article/omz-terminal.html"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle()' onmouseout='$("#i-prev").toggle()'></i></a></li><li><a class="icon" aria-label="Next post" href="/en/article/conda-r-jupyter.html"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle()' onmouseout='$("#i-next").toggle()'></i></a></li><li><a class="icon" aria-label="Back to top" href="#" onclick='$("html, body").animate({scrollTop:0},"fast")'><i class="fas fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle()' onmouseout='$("#i-top").toggle()'></i></a></li><li><a class="icon" aria-label="Switch theme"><i class="fas fa-lightbulb" aria-hidden="true" onmouseover='$("#i-switch").toggle()' onmouseout='$("#i-switch").toggle()' onclick="switchNightMode()"></i></a></li><li><a class="icon" aria-label="Back to home" href="/en/"><i class="fas fa-home" aria-hidden="true" onmouseover='$("#i-home").toggle()' onmouseout='$("#i-home").toggle()'></i></a></li></ul><span id="i-prev" class="info" style="display:none">Previous post</span> <span id="i-next" class="info" style="display:none">Next post</span> <span id="i-top" class="info" style="display:none">Back to top</span> <span id="i-switch" class="info" style="display:none">Switch theme</span> <span id="i-home" class="info" style="display:none">Back to home</span></span><br><div id="toc"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Preface"><span class="toc-number">1.</span> <span class="toc-text">Preface</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Preparation"><span class="toc-number">2.</span> <span class="toc-text">Preparation</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Install-packages"><span class="toc-number">3.</span> <span class="toc-text">Install packages</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Start-Colima"><span class="toc-number">4.</span> <span class="toc-text">Start Colima</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Boot-up"><span class="toc-number">5.</span> <span class="toc-text">Boot-up</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Enjoy"><span class="toc-number">6.</span> <span class="toc-text">Enjoy</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Troubleshooting"><span class="toc-number">7.</span> <span class="toc-text">Troubleshooting</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Additional"><span class="toc-number">8.</span> <span class="toc-text">Additional</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Thanks"><span class="toc-number">9.</span> <span class="toc-text">Thanks</span></a></li></ol></div></span></div><div class="content index py4"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><a href="javascript:void(0);" onclick="switchNightMode()"><h1 class="posttitle" itemprop="name headline">Lightweight docker installation for macOS environment</h1></a><div class="meta"><span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Yuesir</span></span><div class="postdate"><time datetime="2022-11-05T04:49:31.000Z" itemprop="datePublished">2022-11-05</time> (Updated: <time datetime="2023-01-19T08:56:21.000Z" itemprop="dateModified">2023-01-19</time>)</div><div class="article-category"><i class="fas fa-archive"></i> <a class="category-link" href="/en/categories/skill/">skill</a> › <a class="category-link" href="/en/categories/skill/macos/">macos</a></div><div class="article-tag"><i class="fas fa-tag"></i> <a class="tag-link-link" href="/en/tags/colima/" rel="tag">colima</a>, <a class="tag-link-link" href="/en/tags/docker/" rel="tag">docker</a>, <a class="tag-link-link" href="/en/tags/macos/" rel="tag">macos</a></div></div></header><div class="content" itemprop="articleBody"><h2 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h2><p>If you don’t like the “bloat” of the official docker client, like me, and just want a separate and pure docker service without a GUI, or just want to try new things and tinker with new methods, then you are welcome to read this article.</p><p>Since I am using macOS, there is only one exploration record under Mac. If there are any omissions and errors, please feel free to criticize and point them out in the comment section.</p><blockquote><p>Computer environment for this article.</p><p>System：macOS Ventura 13.0.1 (22A400)</p><p>CPU：Intel Core i5（not sure if <em>Apple M series</em> processors are common）</p></blockquote><h2 id="Preparation"><a href="#Preparation" class="headerlink" title="Preparation"></a>Preparation</h2><ul><li><p>Install <a target="_blank" rel="noopener" href="https://brew.sh/">Homebrew</a>.</p><p>Homebrew is the most used package manager under macOS platform, and this is its <a target="_blank" rel="noopener" href="https://docs.brew.sh/Installation">official installation tutorial</a>. But usually, we just need to enter the following command while making sure the network is open.</p><div class="highlight-wrap" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/bin/bash -c <span class="string">&quot;<span class="subst">$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)</span>&quot;</span></span><br></pre></td></tr></table></figure></div></li></ul><h2 id="Install-packages"><a href="#Install-packages" class="headerlink" title="Install packages"></a>Install packages</h2><ul><li><p>Use Homebrew to install docker.</p><p>Installing the most basic docker service is also very simple and can be done with one command.</p><p>Remember not to use the <code>brew install docker --cask</code> command, this will install docker graphically on macOS!!!</p><div class="highlight-wrap" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install docker</span><br></pre></td></tr></table></figure></div></li><li><p>Installing Colima with Homebrew.</p><p><a target="_blank" rel="noopener" href="https://github.com/abiosoft/colima">Colima</a> takes its name from Container on Lima. <a target="_blank" rel="noopener" href="https://github.com/lima-vm/lima">Lima</a> is a virtual machine tool that enables automatic file sharing, port forwarding, and containerd.</p><p>Colima actually starts a virtual machine named <strong>colima</strong> through Lima. It helps us to simplify the usage process, but of course it is less customizable. If you are interested, you can of course use Lima to do the process manually yourself, which is more customizable, but more complex.</p><p>The installation is also very simple and is done with one command.</p><div class="highlight-wrap" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install colima</span><br></pre></td></tr></table></figure></div><p>This should take much longer to download, which is normal. As you can see below, Colima has a lot of dependencies.</p><div class="highlight-wrap" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">$ brew deps colima</span><br><span class="line">bdw-gc</span><br><span class="line">ca-certificates</span><br><span class="line">capstone</span><br><span class="line">gettext</span><br><span class="line">glib</span><br><span class="line">gmp</span><br><span class="line">gnutls</span><br><span class="line">guile</span><br><span class="line">jpeg-turbo</span><br><span class="line">libevent</span><br><span class="line">libidn2</span><br><span class="line">libnghttp2</span><br><span class="line">libpng</span><br><span class="line">libslirp</span><br><span class="line">libssh</span><br><span class="line">libtasn1</span><br><span class="line">libtool</span><br><span class="line">libunistring</span><br><span class="line">libusb</span><br><span class="line">lima</span><br><span class="line">lz4</span><br><span class="line">lzo</span><br><span class="line">m4</span><br><span class="line">ncurses</span><br><span class="line">nettle</span><br><span class="line">openssl@1.1</span><br><span class="line">p11-kit</span><br><span class="line">pcre2</span><br><span class="line">pixman</span><br><span class="line">pkg-config</span><br><span class="line">qemu</span><br><span class="line">readline</span><br><span class="line">snappy</span><br><span class="line">unbound</span><br><span class="line">vde</span><br><span class="line">xz</span><br><span class="line">zstd</span><br></pre></td></tr></table></figure></div></li></ul><h2 id="Start-Colima"><a href="#Start-Colima" class="headerlink" title="Start Colima"></a>Start Colima</h2><p>The official installation documentation describes that creating a docker runtime environment requires only the simplest command.</p><div class="highlight-wrap" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">colima start</span><br></pre></td></tr></table></figure></div><p>Perhaps this is also the reason why the author has optimized the process specifically for docker, which is why I recommend using colima, it’s simple enough.</p><p><a data-fancybox="gallery" data-src="docker-macos/image-20221205160750680.png" data-caption="Colima Run"><picture><source srcset="docker-macos/image-20221205160750680.webp" type="image/webp"><img src="docker-macos/image-20221205160750680.png" alt="Colima Run"></picture></a></p><h2 id="Boot-up"><a href="#Boot-up" class="headerlink" title="Boot-up"></a>Boot-up</h2><p>Although Colima still doesn’t provide such a feature so far, it is <a target="_blank" rel="noopener" href="https://github.com/abiosoft/colima/issues/96">in development</a>.</p><p>Alternatively, for simple single-container docker use, we can create our own shell scripts and set the startup entries to achieve the same effect.</p><ul><li><p>To create the shell script.</p><div class="highlight-wrap" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">touch</span> colima.sh</span><br><span class="line"><span class="built_in">chmod</span> +x colima.sh</span><br></pre></td></tr></table></figure></div></li><li><p>Modify the contents of the script.</p><div class="highlight-wrap" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim colima.sh</span><br></pre></td></tr></table></figure></div><div class="highlight-wrap" data-rel="Code"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># Just write the start command to colima.sh</span><br><span class="line">colima start</span><br></pre></td></tr></table></figure></div></li><li><p>Add to the login entry.</p><p><a data-fancybox="gallery" data-src="docker-macos/image-20221213120548391.png" data-caption="Login Entry"><picture><source srcset="docker-macos/image-20221213120548391.webp" type="image/webp"><img src="docker-macos/image-20221213120548391.png" alt="Login Entry"></picture></a></p></li><li><p>Set the default open method to your terminal program.</p><p><a data-fancybox="gallery" data-src="docker-macos/image-20221213121901639.png" data-caption="Default iTerm2"><picture><source srcset="docker-macos/image-20221213121901639.webp" type="image/webp"><img src="docker-macos/image-20221213121901639.png" alt="Default iTerm2"></picture></a></p></li></ul><h2 id="Enjoy"><a href="#Enjoy" class="headerlink" title="Enjoy"></a>Enjoy</h2><p>It’s that simple, and the docker service is up and running. Type <code>docker ps -a</code> and simply test to see if it runs successfully. If you still have errors, keep reading on.</p><p><a data-fancybox="gallery" data-src="docker-macos/image-20221205160832483.png" data-caption="Docker Run"><picture><source srcset="docker-macos/image-20221205160832483.webp" type="image/webp"><img src="docker-macos/image-20221205160832483.png" alt="Docker Run"></picture></a></p><h2 id="Troubleshooting"><a href="#Troubleshooting" class="headerlink" title="Troubleshooting"></a>Troubleshooting</h2><p><a data-fancybox="gallery" data-src="docker-macos/image-20221205153421353.png" data-caption="Docker No Service"><picture><source srcset="docker-macos/image-20221205153421353.webp" type="image/webp"><img src="docker-macos/image-20221205153421353.png" alt="Docker No Service"></picture></a></p><p>The diagram indicates that the docker service is not running, which is a problem with the colima configuration. You can try to reinstall Colima or re-run <code>colima start</code> to check if it is resolved.</p><h2 id="Additional"><a href="#Additional" class="headerlink" title="Additional"></a>Additional</h2><ul><li><p>You can further install <strong>docker-compose</strong> to use it.</p><div class="highlight-wrap" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install docker-compose</span><br></pre></td></tr></table></figure></div></li><li><p>If you want to run multiple containers, you can make configuration changes to the containers created by Colima.</p><p>Colima’s default resource configuration is 2 CPU / 2 G memory, which may not be enough in some cases. For example, if you start three mysql instances with docker-compose, it will happen that at least one of them will not start properly.</p><p>In this case, you can change the default configuration with the <code>-c</code> and <code>-m</code> start parameters, or with <code>colima start --edit</code>.</p></li></ul><h2 id="Thanks"><a href="#Thanks" class="headerlink" title="Thanks"></a>Thanks</h2><p><a target="_blank" rel="noopener" href="https://github.com/abiosoft/colima">Colima</a></p><p><a target="_blank" rel="noopener" href="https://github.com/lima-vm/lima">Lima</a></p><p><a target="_blank" rel="noopener" href="https://www.docker.com/">Docker</a></p><div id="copyright"><style>#easter-egg{border:0;padding:10px 0;position:relative}#easter-egg::before{font-family:"Font Awesome 5 Free";font-weight:900;content:"Page Over \f1b0  Thank You";position:absolute;padding:0 10px;line-height:1px;white-space:nowrap;left:50%;transform:translateX(-50%)}</style><hr id="easter-egg"><blockquote style="padding:0"><p>Author: Yuesir</p><p>Link: <a href="/en/article/docker-macos.html" target="_blank" title="Lightweight docker installation for macOS environment">https://vccv.cc/en/article/docker-macos.html</a></p><p>Copyright: All articles except special statements are used <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">CC BY-NC-ND 4.0</a> license agreement, reproduced please indicate the source!</p></blockquote><hr></div></div></article><div class="blog-post-comments"><div id="tcomment"><noscript>Please enable JavaScript to view the comments.</noscript></div></div><div id="footer-post-container"><div id="footer-post"><div id="nav-footer" style="display:none"><ul><li><a href="/en/">Home</a></li><li><a href="/en/tags">Tag</a></li><li><a href="/en/search">Search</a></li><li><a href="/en/tools">Tool</a></li><li><a href="/en/about">About</a></li></ul></div><div id="toc-footer" style="display:none"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Preface"><span class="toc-number">1.</span> <span class="toc-text">Preface</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Preparation"><span class="toc-number">2.</span> <span class="toc-text">Preparation</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Install-packages"><span class="toc-number">3.</span> <span class="toc-text">Install packages</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Start-Colima"><span class="toc-number">4.</span> <span class="toc-text">Start Colima</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Boot-up"><span class="toc-number">5.</span> <span class="toc-text">Boot-up</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Enjoy"><span class="toc-number">6.</span> <span class="toc-text">Enjoy</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Troubleshooting"><span class="toc-number">7.</span> <span class="toc-text">Troubleshooting</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Additional"><span class="toc-number">8.</span> <span class="toc-text">Additional</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Thanks"><span class="toc-number">9.</span> <span class="toc-text">Thanks</span></a></li></ol></div><div id="actions-footer"><a id="menu" class="icon" onclick='$("#nav-footer").toggle()'><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a> <a id="toc" class="icon" onclick='$("#toc-footer").toggle()'><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a> <a id="switch" class="icon" onclick="switchNightMode()"><i class="fas fa-lightbulb fa-lg" aria-hidden="true"></i> Theme</a> <a id="top" style="display:none" class="icon" href="#" onclick='$("html, body").animate({scrollTop:0},"fast")'><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a></div></div></div><footer id="footer"><div class="footer-left">Copyright &copy; 2020-2023 Yuesir <a href="https://github.com/probberechts/hexo-theme-cactus" rel="nofollow" target="_blank">Cactus</a> <a href="/en/atom.xml" target="_blank">RSS</a></div><div class="footer-right"><nav><ul><li><a href="/en/">Home</a></li><li><a href="/en/tags">Tag</a></li><li><a href="/en/search">Search</a></li><li><a href="/en/tools">Tool</a></li><li><a href="/en/about">About</a></li></ul></nav></div></footer></div><link rel="preload" href="/en/lib/font-awesome/css/all.min.css" as="style" onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel="stylesheet" href="/en/lib/font-awesome/css/all.min.css"></noscript><script src="/en/lib/jquery/jquery.min.js"></script><script src="/en/lib/clipboard/clipboard.min.js"></script><script type="text/javascript">$((function(){$(".highlight table").before('<span class="btn-copy tooltipped tooltipped-sw" aria-label="Copy to clipboard"><i class="far fa-clone"></i></span>'),new ClipboardJS(".btn-copy",{text:function(e){return Array.from(e.nextElementSibling.querySelectorAll(".code")).reduce((e,t)=>e+t.innerText+"\n","").replace(/^\s+|\s+$/g,"")}}).on("success",(function(e){e.trigger.setAttribute("aria-label","Copied!"),e.clearSelection()}))}))</script><script src="/en/js/main.js"></script><script src="/en/lib/fancybox/fancybox.umd.js"></script><script src="/en/lib/twikoo/twikoo.all.min.js"></script><script>twikoo.init({envId:"https://twikoo.vccv.cc",el:"#tcomment",lang:"en",onCommentLoaded:function(){for(var t=document.getElementsByClassName("tk-content"),e=0;e<t.length;e++){var n=t[e].getElementsByTagName("img");if(n.length>0)for(var a=0;a<n.length;a++){var o=n[a];if("tk-owo-emotion"!=o.className){var r=document.createElement("a");r.setAttribute("data-fancybox","gallery"),r.setAttribute("data-src",o.getAttribute("src")),r.setAttribute("data-caption","Comment: "+o.getAttribute("alt")),r.appendChild(o.cloneNode(!1)),o.parentNode.insertBefore(r,o.nextSibling),o.remove()}}}}})</script><script async>window.onload=function(){var a=document.createElement('script'),b=document.getElementsByTagName('script')[0];a.type='text/javascript',a.async=!0,a.src='/sw-register.js?v='+Date.now(),b.parentNode.insertBefore(a,b)};</script></body></html>